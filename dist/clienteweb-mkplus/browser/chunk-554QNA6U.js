import{a as X}from"./chunk-3QEI6ENN.js";import{f as Z,g as q,h as K,p as J,u as Q,v as k}from"./chunk-Z5HBHXP3.js";import{b as x,d as w,e as D,f as j,g as N,h as B,i as U,r as H,s as G,u as A}from"./chunk-YPYZVSIH.js";import{a as O}from"./chunk-I2A4HNRV.js";import{s as P,x as F}from"./chunk-JJK3Y3Z5.js";import{Bb as g,Db as _,Ea as l,Ob as r,Pb as f,Qb as W,Va as y,Vb as d,Wb as p,X as V,Xb as c,aa as u,fa as b,fb as E,ga as h,gb as C,jb as L,kb as z,lb as I,mb as t,nb as e,ob as T,ub as v}from"./chunk-XFJKNVDY.js";import{h as R}from"./chunk-FJYW2LMB.js";var Y={cl:"",codigoModelo:"",nombre:"",insumos:0,manoObra:0,rutinaMantenimiento:{kilometros:0,horas:0}},$={cl:"",codigoModelo:"",nombre:"",salto:0,limite:10};var M=class m{http=u(F);servicio=`${O.api}${O.paths.tempario}`;consultarTemparios=o=>{try{return this.http.post(this.servicio+"/consulta",o)}catch(n){return n}};eliminarTempario=o=>{try{return this.http.post(this.servicio+"/eliminar",o)}catch(n){return n}};crearTempario=o=>{try{return this.http.post(this.servicio+"/crear",o)}catch(n){return n}};actualizarTempario=o=>{try{return this.http.post(this.servicio+"/actualizar",o)}catch(n){return n}};static \u0275fac=function(n){return new(n||m)};static \u0275prov=V({token:m,factory:m.\u0275fac,providedIn:"root"})};function ae(m,o){m&1&&(t(0,"div",19),r(1," Por favor completa todos los campos obligatorios. "),e())}function ne(m,o){if(m&1){let n=v();t(0,"button",23),g("click",function(){b(n);let s=_();return h(s.actualizarTempario())}),r(1," ACTUALIZAR "),e()}}function re(m,o){if(m&1){let n=v();t(0,"button",23),g("click",function(){b(n);let s=_();return h(s.guardarTempario())}),r(1," GUARDAR "),e()}}var S=class m{temparioService=u(M);utilidadesService=u(k);modalActivo=u(q);evento="EVENTO_GUARDAR";cargando=!1;mensaje=!1;datosTempario=Object.assign({},Y);guardarTempario=()=>{this.temparioService.crearTempario(this.datosTempario).subscribe({next:o=>{o.estatus?this.utilidadesService.abrirModalInfo("Informaci\xF3n",`Tempario ${this.datosTempario.nombre} creado con \xE9xito.`,"Aceptar"):this.utilidadesService.abrirModalInfo("Informaci\xF3n","No se ha podido crear el tempario.","Aceptar"),this.cargando=!1,this.modalActivo.close(!0)},error:o=>{this.utilidadesService.abrirModalInfo("Informaci\xF3n",o.error.resultadoOperacion,"Aceptar"),this.cargando=!1}})};actualizarTempario=()=>{delete this.datosTempario.creado,delete this.datosTempario.actualizado,"__v"in this.datosTempario&&delete this.datosTempario.__v,"editado"in this.datosTempario&&delete this.datosTempario.editado,this.temparioService.actualizarTempario(this.datosTempario).subscribe({next:o=>{o.estatus?this.utilidadesService.abrirModalInfo("Informaci\xF3n",`Tempario ${this.datosTempario.nombre} actualizado con \xE9xito.`,"Aceptar"):this.utilidadesService.abrirModalInfo("Informaci\xF3n","No se ha podido actualizar el tempario.","Aceptar"),this.cargando=!1,this.modalActivo.close(!0)},error:o=>{this.utilidadesService.abrirModalInfo("Informaci\xF3n",o.error.resultadoOperacion,"Aceptar"),this.cargando=!1}})};static \u0275fac=function(n){return new(n||m)};static \u0275cmp=y({type:m,selectors:[["app-modal-temparios"]],inputs:{evento:"evento"},decls:52,vars:10,consts:[["tabindex","-1","aria-modal","true","role","dialog",1,"modal","fade","show",2,"display","block"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"mb-3"],[1,"row","g-3","mb-3"],[1,"col-md-4"],[1,"form-label"],["name","nombre",1,"form-control",3,"ngModelChange","ngModel"],["name","codigoModelo",1,"form-control",3,"ngModelChange","ngModel"],["name","cl","maxlength","5","minlength","5",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-6"],["type","number","name","insumos",1,"form-control",3,"ngModelChange","ngModel"],["type","number","name","manoObra",1,"form-control",3,"ngModelChange","ngModel"],["type","number","name","kilometros",1,"form-control",3,"ngModelChange","ngModel"],["type","number","name","horas",1,"form-control",3,"ngModelChange","ngModel"],[1,"alert","alert-warning"],[1,"modal-footer"],["type","button",1,"btn","boton-secondary-kia"],["type","button",1,"btn","boton-principal-kia"],["type","button",1,"btn","boton-principal-kia",3,"click"]],template:function(n,i){n&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5",4),r(5,"Formulario Temparios"),e(),T(6,"button",5),e(),t(7,"div",6)(8,"form")(9,"h6",7),r(10,"Nombre del Tempario"),e(),t(11,"div",8)(12,"div",9)(13,"label",10),r(14,"Nombre"),e(),t(15,"input",11),c("ngModelChange",function(a){return p(i.datosTempario.nombre,a)||(i.datosTempario.nombre=a),a}),e()(),t(16,"div",9)(17,"label",10),r(18,"C\xF3digo de Modelo"),e(),t(19,"input",12),c("ngModelChange",function(a){return p(i.datosTempario.codigoModelo,a)||(i.datosTempario.codigoModelo=a),a}),e()(),t(20,"div",9)(21,"label",10),r(22,"C\xF3digo Concesionario (cl)"),e(),t(23,"input",13),c("ngModelChange",function(a){return p(i.datosTempario.cl,a)||(i.datosTempario.cl=a),a}),e()()(),t(24,"h6",7),r(25,"Valores"),e(),t(26,"div",8)(27,"div",14)(28,"label",10),r(29,"Valor de los Insumos"),e(),t(30,"input",15),c("ngModelChange",function(a){return p(i.datosTempario.insumos,a)||(i.datosTempario.insumos=a),a}),e()(),t(31,"div",14)(32,"label",10),r(33,"Tarifa Mano de Obra"),e(),t(34,"input",16),c("ngModelChange",function(a){return p(i.datosTempario.manoObra,a)||(i.datosTempario.manoObra=a),a}),e()()(),t(35,"h6",7),r(36,"Rutina de Mantenimiento"),e(),t(37,"div",8)(38,"div",14)(39,"label",10),r(40,"Kil\xF3metros"),e(),t(41,"input",17),c("ngModelChange",function(a){return p(i.datosTempario.rutinaMantenimiento.kilometros,a)||(i.datosTempario.rutinaMantenimiento.kilometros=a),a}),e()(),t(42,"div",14)(43,"label",10),r(44,"Horas"),e(),t(45,"input",18),c("ngModelChange",function(a){return p(i.datosTempario.rutinaMantenimiento.horas,a)||(i.datosTempario.rutinaMantenimiento.horas=a),a}),e()()()(),E(46,ae,2,0,"div",19),e(),t(47,"div",20)(48,"button",21),r(49," CANCELAR "),e(),E(50,ne,2,0,"button",22),E(51,re,2,0,"button",22),e()()()()),n&2&&(l(15),d("ngModel",i.datosTempario.nombre),l(4),d("ngModel",i.datosTempario.codigoModelo),l(4),d("ngModel",i.datosTempario.cl),l(7),d("ngModel",i.datosTempario.insumos),l(4),d("ngModel",i.datosTempario.manoObra),l(7),d("ngModel",i.datosTempario.rutinaMantenimiento.kilometros),l(4),d("ngModel",i.datosTempario.rutinaMantenimiento.horas),l(),C(i.mensaje?46:-1),l(4),C(i.evento==="EVENTO_ACTUALIZAR"?50:-1),l(),C(i.evento==="EVENTO_GUARDAR"?51:-1))},dependencies:[A,B,x,U,w,D,H,G,N,j],encapsulation:2})};var le=(m,o)=>o._id;function me(m,o){if(m&1){let n=v();t(0,"tr")(1,"td"),r(2),e(),t(3,"td"),r(4),e(),t(5,"td"),r(6),e(),t(7,"td"),r(8),e(),t(9,"td"),r(10),e(),t(11,"td"),r(12),e(),t(13,"td"),r(14),e(),t(15,"td",25)(16,"div",26)(17,"button",27),g("click",function(){let s=b(n).$implicit,a=_();return h(a.actualizar(s))}),T(18,"i",28),r(19," Editar "),e(),t(20,"button",29),g("click",function(){let s=b(n).$implicit,a=_();return h(a.eliminarTempario(s))}),T(21,"i",30),r(22," Eliminar "),e()()()()}if(m&2){let n=o.$implicit;l(2),f(n.nombre),l(2),f(n.cl),l(2),f(n.codigoModelo),l(2),f(n.insumos||0),l(2),f(n.manoObra),l(2),W("",n.rutinaMantenimiento.kilometros," km"),l(2),f(n.rutinaMantenimiento.horas)}}function se(m,o){m&1&&(t(0,"tr")(1,"td",31),r(2," No hay temparios registrados actualmente. "),e()())}var te=class m{temparioService=u(M);utilidadesService=u(k);modalService=u(K);filtro=Object.assign({},$);cargando=!1;total=0;pagina=1;temparios=[];cls=[];ngOnInit(){this.consultar()}cambiarPagina=o=>{this.filtro.salto=(o-1)*this.filtro.limite,this.consultar()};crear=()=>R(this,null,function*(){let o=this.modalService.open(S,{centered:!0,size:"xl"});o.componentInstance.evento="EVENTO_GUARDAR",(yield o.result)&&this.consultar()});actualizar=o=>R(this,null,function*(){let n=this.modalService.open(S,{centered:!0,size:"xl"});n.componentInstance.evento="EVENTO_ACTUALIZAR",n.componentInstance.datosTempario=o,(yield n.result)&&this.consultar()});eliminar=o=>{this.cargando=!0,this.temparioService.eliminarTempario({id:o}).subscribe({next:n=>{n.estatus&&this.utilidadesService.abrirModalInfo("Informaci\xF3n",n.resultadoOperacion,"Aceptar"),this.cargando=!1,this.consultar()},error:n=>{this.utilidadesService.abrirModalInfo("Informaci\xF3n",n.error.resultadoOperacion,"Aceptar"),this.cargando=!1}})};eliminarTempario=o=>{this.utilidadesService.abrirModalConfirmacion("Eliminar modelo",`Estas seguro que quieres eliminar el tempario ${o.nombre}?`,"Eliminar","Cancelar").then(n=>{n&&this.eliminar(o._id??"")})};consultar=()=>{if(this.cargando=!0,typeof this.filtro.cl=="string"){let o=this.filtro.cl.trim();this.filtro.cl=o?[o]:[]}this.temparioService.consultarTemparios(this.filtro).subscribe({next:o=>{o.estatus&&(this.temparios=o.data.temparios,this.total=o.data.total),this.cargando=!1},error:o=>{this.utilidadesService.abrirModalInfo("Informaci\xF3n",o.error.resultadoOperacion,"Aceptar"),this.cargando=!1}})};static \u0275fac=function(n){return new(n||m)};static \u0275cmp=y({type:m,selectors:[["app-temparios-normal"]],decls:51,vars:11,consts:[[3,"messageInput","loading"],[1,"container","py-5","mt-5"],[1,"d-flex","flex-column","flex-md-row","justify-content-between","align-items-md-center","mb-4"],[1,"fw-bold","text-dark","mb-1"],[1,"text-muted","mb-0"],[1,"btn","boton-principal-kia","mt-3",3,"click"],[1,"card","border-0","rounded-3","mb-4","shadow-sm"],[1,"card-body","d-flex","flex-wrap","align-items-center","gap-3"],[1,"fw-semibold","mb-0"],[1,"flex-grow-1",2,"min-width","220px"],["placeholder","Nombre","name","filtroNombre",1,"form-control","rounded-pill","px-3",3,"ngModelChange","ngModel"],[1,"flex-grow-1",2,"min-width","150px"],["placeholder","CL","name","filtroCl",1,"form-control","rounded-pill","px-3",3,"ngModelChange","ngModel"],[1,"flex-grow-1",2,"min-width","200px"],["placeholder","Modelo","name","filtroModelo",1,"form-control","rounded-pill","px-3",3,"ngModelChange","ngModel"],[1,"btn","btn-outline-dark","rounded-pill","px-4",3,"click"],[1,"card","border-0","shadow-sm","rounded-4"],[1,"table-responsive"],[1,"table","align-middle","mb-0"],[1,"table-light"],[1,"fw-semibold"],[1,"fw-semibold","text-center"],[1,"card-footer","d-flex","justify-content-between","align-items-center"],[1,"text-muted"],[3,"pageChange","collectionSize","pageSize","page","maxSize"],[1,"text-center"],[1,"d-flex","justify-content-center","gap-2"],[1,"btn","btn-outline-dark","rounded-pill","px-3","d-inline-flex","align-items-center","gap-2",3,"click"],[1,"fa-solid","fa-pen-to-square"],[1,"btn","btn-outline-secondary","rounded-pill","px-3","d-inline-flex","align-items-center","gap-2",3,"click"],[1,"fa-solid","fa-trash"],["colspan","8",1,"text-center","py-4","text-muted"]],template:function(n,i){n&1&&(T(0,"app-loading-screen",0),t(1,"div",1)(2,"div",2)(3,"div")(4,"h3",3),r(5,"Temparios"),e(),t(6,"p",4),r(7," Gesti\xF3n y administraci\xF3n de temparios registrados. "),e()(),t(8,"button",5),g("click",function(){return i.crear()}),r(9," Nuevo tempario "),e()(),t(10,"div",6)(11,"div",7)(12,"h6",8),r(13,"Filtrar por:"),e(),t(14,"div",9)(15,"input",10),c("ngModelChange",function(a){return p(i.filtro.nombre,a)||(i.filtro.nombre=a),a}),e()(),t(16,"div",11)(17,"input",12),c("ngModelChange",function(a){return p(i.filtro.cl,a)||(i.filtro.cl=a),a}),e()(),t(18,"div",13)(19,"input",14),c("ngModelChange",function(a){return p(i.filtro.codigoModelo,a)||(i.filtro.codigoModelo=a),a}),e()(),t(20,"button",15),g("click",function(){return i.consultar()}),r(21," Buscar "),e()()(),t(22,"div",16)(23,"div",17)(24,"table",18)(25,"thead",19)(26,"tr")(27,"th",20),r(28,"Nombre"),e(),t(29,"th",20),r(30,"CL"),e(),t(31,"th",20),r(32,"Modelo"),e(),t(33,"th",20),r(34,"Insumos"),e(),t(35,"th",20),r(36,"Mano de obra"),e(),t(37,"th",20),r(38,"Rutina"),e(),t(39,"th",20),r(40,"Horas"),e(),t(41,"th",21),r(42,"Acciones"),e()()(),t(43,"tbody"),L(44,me,23,7,"tr",null,le,!1,se,3,0,"tr"),e()()(),t(47,"div",22)(48,"div",23),r(49),e(),t(50,"ngb-pagination",24),c("pageChange",function(a){return p(i.pagina,a)||(i.pagina=a),a}),g("pageChange",function(a){return i.cambiarPagina(a)}),e()()()()),n&2&&(I("messageInput","Cargando...")("loading",i.cargando),l(15),d("ngModel",i.filtro.nombre),l(2),d("ngModel",i.filtro.cl),l(2),d("ngModel",i.filtro.codigoModelo),l(25),z(i.temparios),l(5),W(" Mostrando ",i.temparios.length," tempario(s) "),l(),I("collectionSize",i.total)("pageSize",i.filtro.limite),d("page",i.pagina),I("maxSize",10))},dependencies:[P,A,x,w,N,Q,J,X,Z],encapsulation:2})};export{te as TempariosNormal};
