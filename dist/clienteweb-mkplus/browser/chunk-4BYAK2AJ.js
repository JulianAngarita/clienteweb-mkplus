import{a as X}from"./chunk-3YKSX6TR.js";import{a as J}from"./chunk-YQHSFYFW.js";import{a as Q}from"./chunk-GN2ZQHZ5.js";import{a as z}from"./chunk-I4STTD3A.js";import{a as q}from"./chunk-3QEI6ENN.js";import{g as K,v as U}from"./chunk-RRJ2G4CW.js";import{b as O,d as P,g as N,m as L,n as j,p as G,u as H}from"./chunk-YPYZVSIH.js";import{q as A,s as B}from"./chunk-JJK3Y3Z5.js";import{Bb as R,Db as m,Ea as r,Ob as n,Pb as x,Qb as s,Va as F,Vb as _,Wb as S,Xb as g,aa as E,fa as p,fb as M,fc as f,ga as u,gb as w,hb as V,jb as C,jc as b,kb as h,lb as I,mb as i,nb as e,ob as v,ub as k}from"./chunk-XFJKNVDY.js";import{a as D,b as T,h as W}from"./chunk-FJYW2LMB.js";var Z=(c,l)=>l._id;function $(c,l){if(c&1&&(i(0,"option",21),n(1),e()),c&2){let t=l.$implicit;I("value",t.value),r(),s(" ",t.text," ")}}function ee(c,l){if(c&1&&(i(0,"option",21),n(1),e()),c&2){let t=l.$implicit;I("value",t.value),r(),x(t.text)}}function ie(c,l){if(c&1&&(i(0,"option",21),n(1),e()),c&2){let t=l.$implicit;I("value",t.value),r(),x(t.text)}}function te(c,l){if(c&1){let t=k();i(0,"div")(1,"div",15)(2,"h5"),n(3,"Redenci\xF3n"),e(),i(4,"button",16),R("click",function(){p(t);let o=m();return u(o.redimirServicio())}),n(5," Redimir "),e()(),i(6,"div",10)(7,"h6"),n(8,"Nombre"),e(),i(9,"div",17)(10,"label",18),n(11,"Nombres"),e(),i(12,"input",19),g("ngModelChange",function(o){p(t);let a=m();return S(a.servicio.redencion.nombres.nombres,o)||(a.servicio.redencion.nombres.nombres=o),u(o)}),e()(),i(13,"div",17)(14,"label",18),n(15,"Apellidos"),e(),i(16,"input",19),g("ngModelChange",function(o){p(t);let a=m();return S(a.servicio.redencion.nombres.apellidos,o)||(a.servicio.redencion.nombres.apellidos=o),u(o)}),e()()(),i(17,"div",10)(18,"h6"),n(19,"Identificaci\xF3n"),e(),i(20,"div",17)(21,"label",18),n(22,"Tipo de identificaci\xF3n"),e(),i(23,"select",20),g("ngModelChange",function(o){p(t);let a=m();return S(a.servicio.redencion.identificacion.tipo,o)||(a.servicio.redencion.identificacion.tipo=o),u(o)}),C(24,$,2,2,"option",21,V),e()(),i(26,"div",17)(27,"label",18),n(28,"N\xFAmero"),e(),i(29,"input",19),g("ngModelChange",function(o){p(t);let a=m();return S(a.servicio.redencion.identificacion.numero,o)||(a.servicio.redencion.identificacion.numero=o),u(o)}),e()()(),i(30,"div",10)(31,"h6"),n(32,"Concesionario"),e(),i(33,"div",17)(34,"label",18),n(35,"Grupo"),e(),i(36,"select",22),R("change",function(){p(t);let o=m();return u(o.toggleGrupo())}),g("ngModelChange",function(o){p(t);let a=m();return S(a.grupoSeleccionado,o)||(a.grupoSeleccionado=o),u(o)}),C(37,ee,2,2,"option",21,V),e()(),i(39,"div",17)(40,"label",18),n(41,"Concesionario"),e(),i(42,"select",20),g("ngModelChange",function(o){p(t);let a=m();return S(a.servicio.redencion.concesionario.cl,o)||(a.servicio.redencion.concesionario.cl=o),u(o)}),C(43,ie,2,2,"option",21,V),e()()(),i(45,"div",10)(46,"h6"),n(47,"Otros datos"),e(),i(48,"div",17)(49,"label",18),n(50,"Link de la inspecci\xF3n"),e(),i(51,"input",19),g("ngModelChange",function(o){p(t);let a=m();return S(a.servicio.redencion.linkInspeccion,o)||(a.servicio.redencion.linkInspeccion=o),u(o)}),e()(),i(52,"div",17)(53,"label",18),n(54,"N\xFAmero Orden"),e(),i(55,"input",19),g("ngModelChange",function(o){p(t);let a=m();return S(a.servicio.redencion.numeroOrdenTrabajo,o)||(a.servicio.redencion.numeroOrdenTrabajo=o),u(o)}),e()()(),i(56,"div",10)(57,"div",17)(58,"label",18),n(59,"Fecha Entrega Veh\xEDculo"),e(),i(60,"input",23),g("ngModelChange",function(o){p(t);let a=m();return S(a.servicio.redencion.fechaEntregaVehiculo,o)||(a.servicio.redencion.fechaEntregaVehiculo=o),u(o)}),e()(),i(61,"div",17)(62,"label",18),n(63,"Kilometraje"),e(),i(64,"input",19),g("ngModelChange",function(o){p(t);let a=m();return S(a.servicio.redencion.kilometrajeActual,o)||(a.servicio.redencion.kilometrajeActual=o),u(o)}),e()()(),i(65,"div",10)(66,"div",24)(67,"label",18),n(68,"Comentarios..."),e(),i(69,"textarea",25),g("ngModelChange",function(o){p(t);let a=m();return S(a.servicio.redencion.comentarios,o)||(a.servicio.redencion.comentarios=o),u(o)}),e()()()()}if(c&2){let t=m();r(12),_("ngModel",t.servicio.redencion.nombres.nombres),r(4),_("ngModel",t.servicio.redencion.nombres.apellidos),r(7),_("ngModel",t.servicio.redencion.identificacion.tipo),r(),h(t.tipoIdentificacionOpciones),r(5),_("ngModel",t.servicio.redencion.identificacion.numero),r(7),_("ngModel",t.grupoSeleccionado),r(),h(t.listaGrupos),r(5),_("ngModel",t.servicio.redencion.concesionario.cl),r(),h(t.concesionariosSeleccionados),r(8),_("ngModel",t.servicio.redencion.linkInspeccion),r(4),_("ngModel",t.servicio.redencion.numeroOrdenTrabajo),r(5),_("ngModel",t.servicio.redencion.fechaEntregaVehiculo),r(4),_("ngModel",t.servicio.redencion.kilometrajeActual),r(5),_("ngModel",t.servicio.redencion.comentarios)}}function ne(c,l){if(c&1&&(i(0,"div",10)(1,"h6"),n(2,"Usuario que redime"),e(),i(3,"div",24)(4,"p",26)(5,"strong"),n(6,"Nombre:"),e(),n(7),e(),i(8,"p",26)(9,"strong"),n(10,"Identificaci\xF3n:"),e(),n(11),e(),i(12,"p",26)(13,"strong"),n(14,"Correo electr\xF3nico:"),e(),n(15),e()()()),c&2){let t=m();r(7),s(" ",t.servicio.redencion.usuarioQueRedime.nombreCompleto),r(4),s(" ",t.servicio.redencion.usuarioQueRedime.identificacion),r(4),s(" ",t.servicio.redencion.usuarioQueRedime.email)}}function oe(c,l){if(c&1&&(i(0,"div",5)(1,"div",8)(2,"h6",27),n(3,"Prepagado"),e(),i(4,"div",9)(5,"strong"),n(6,"Insumos: "),e(),n(7),f(8,"currency"),v(9,"br"),i(10,"strong"),n(11,"Mano de obra: "),e(),n(12),f(13,"currency"),v(14,"br"),i(15,"strong"),n(16,"Repuestos: "),e(),n(17),f(18,"currency"),v(19,"br"),i(20,"strong"),n(21,"Comisi\xF3n: "),e(),n(22),f(23,"currency"),v(24,"br"),i(25,"strong"),n(26,"IVA: "),e(),n(27),f(28,"currency"),v(29,"br"),i(30,"strong"),n(31,"Total: "),e(),n(32),f(33,"currency"),e()()(),v(34,"hr")),c&2){let t=m();r(7),s(" ",b(8,6,t.servicio.precios.prepagado.insumos,"$ ","symbol","0.0")," "),r(5),s(" ",b(13,11,t.servicio.precios.prepagado.manoObra,"$ ","symbol","0.0")," "),r(5),s(" ",b(18,16,t.servicio.precios.prepagado.repuestos,"$ ","symbol","0.0")," "),r(5),s(" ",b(23,21,t.servicio.precios.prepagado.comision,"$ ","symbol","0.0")," "),r(5),s(" ",b(28,26,t.servicio.precios.prepagado.iva,"$ ","symbol","0.0")," "),r(5),s(" ",b(33,31,t.servicio.precios.prepagado.total,"$ ","symbol","0.0")," ")}}function re(c,l){if(c&1&&(i(0,"tr")(1,"td"),n(2),e(),i(3,"td"),n(4),e(),i(5,"td"),n(6),e(),i(7,"td"),n(8),e(),i(9,"td"),n(10),e(),i(11,"td"),n(12),e(),i(13,"td"),n(14),e()()),c&2){let t=l.$implicit;r(2),x(t.referencia),r(2),x(t.pnc),r(2),x(t.cantidad),r(2),x(t.margen.precioVentaConcesionario),r(2),x(t.margen.precioVentaPublico),r(2),s("$ ",t.precioVenta.concesionario),r(2),s("$ ",t.precioVenta.publico)}}function ae(c,l){c&1&&(i(0,"tr")(1,"td",33),n(2," No hay repuestos registrados actualmente. "),e()())}function le(c,l){if(c&1&&(i(0,"div",29)(1,"table",30)(2,"thead")(3,"tr")(4,"th",31),n(5,"Referencia"),e(),i(6,"th",31),n(7,"PNC"),e(),i(8,"th",31),n(9,"Cantidad"),e(),i(10,"th",32),n(11,"Margen"),e(),i(12,"th",32),n(13,"Precio venta"),e()(),i(14,"tr")(15,"th"),n(16,"Concesionario"),e(),i(17,"th"),n(18,"P\xFAblico"),e(),i(19,"th"),n(20,"Concesionario"),e(),i(21,"th"),n(22,"P\xFAblico"),e()()(),i(23,"tbody"),C(24,re,15,7,"tr",null,Z,!1,ae,3,0,"tr"),e()()()),c&2){let t=m().$implicit;r(24),h(t.repuestos)}}function ce(c,l){if(c&1&&(i(0,"div",11)(1,"strong"),n(2),e(),i(3,"div",28)(4,"span"),n(5),e(),i(6,"span"),n(7),e()(),M(8,le,27,1,"div",29),e()),c&2){let t=l.$implicit;r(2),x(t.nombre),r(3),s("C\xF3digo: ",t.codigo),r(2),s("Horas: ",t.horas),r(),w(t.repuestos.length>0?8:-1)}}function de(c,l){c&1&&(i(0,"div",12),n(1,"Sin operaciones registradas"),e())}var Y=class c{concesionarioService=E(Q);activeModal=E(K);utilidadesService=E(U);solicitudService=E(J);evento="informacion";servicio=structuredClone(z);idSolicitud="";idServicio="";listaConcesionarios=[];cargando=!1;listaGrupos=[];concesionariosSeleccionados=[];tipoIdentificacionOpciones=X;grupoSeleccionado="";ngOnInit(){this.consultaConcesiones(),this.servicio._id||this.consultarServicioARedimir()}toggleGrupo=()=>{this.servicio.redencion.concesionario.grupo=this.grupoSeleccionado,this.concesionariosSeleccionados=this.listaConcesionarios.filter(l=>this.grupoSeleccionado===l.grupo)};consultarServicioARedimir=()=>{this.cargando=!0,this.solicitudService.consultaServicioRedimir({idServicio:this.idServicio,idSolicitud:this.idSolicitud}).subscribe({next:l=>{this.cargando=!1,l.estatus?this.servicio=l.data.servicio:this.utilidadesService.abrirModalInfo("Informaci\xF3n",l.resultadoOperacion,"Aceptar")},error:l=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",l.error.resultadoOperacion,"Aceptar")}})};redimirServicio=()=>{this.cargando=!0,this.servicio.redencion.concesionario.tarifaManoObra="",delete this.servicio.redencion.estatus;let l=T(D({},this.servicio.redencion),{idServicio:this.servicio._id??"",idSolicitud:this.idSolicitud});this.solicitudService.redimirServicio(l).subscribe({next:t=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",t.resultadoOperacion,"Aceptar"),t.estatus&&this.activeModal.close(!0)},error:t=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",t.error.resultadoOperacion,"Aceptar")}})};consultaConcesiones(){return W(this,null,function*(){this.concesionarioService.consultarcl().subscribe({next:l=>{if(l.estatus){let t=l.data,d=[],o=[];t.map(a=>{o.push({key:a.grupo,text:a.grupo,value:a.grupo}),a.concesiones.map(y=>{d.push({grupo:a.grupo,key:`${a.grupo} ${y.nombre} ${y.cl}`,text:`${y.nombre} ${y.cl}`,value:y.cl})})}),this.listaConcesionarios=d,this.listaGrupos=o}},error:l=>{this.utilidadesService.abrirModalInfo("Informaci\xF3n",l.error.resultadoOperacio,"Aceptar")}})})}formatCurrency(l){return new Intl.NumberFormat("es-CO",{minimumFractionDigits:0,maximumFractionDigits:0}).format(l)}static \u0275fac=function(t){return new(t||c)};static \u0275cmp=F({type:c,selectors:[["app-modal-detalles-servicio-redencion"]],inputs:{evento:"evento",servicio:"servicio",idSolicitud:"idSolicitud",idServicio:"idServicio"},decls:45,vars:11,consts:[[3,"messageInput","loading"],[1,"modal-header","border-0","pb-0","animate__animated","animate__fadeIn"],[1,"modal-title","fw-semibold","text-dark"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body","animate__animated","animate__fadeIn"],[1,"row"],[1,"col-md-12","mb-4"],[1,"card-body"],[1,"col-6"],[1,"small"],[1,"row","mb-4"],[1,"p-2","border","rounded","mb-2","mt-3"],[1,"text-muted","small"],[1,"modal-footer","border-0","pt-0","animate__animated","animate__fadeIn"],["type","button",1,"btn","boton-principal-kia",3,"click"],[1,"d-flex","justify-content-between","mb-3"],[1,"btn","boton-secondary-kia",3,"click"],[1,"col-md-6"],[1,"form-label"],["type","text",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-select",3,"ngModelChange","ngModel"],[3,"value"],[1,"form-select",3,"change","ngModelChange","ngModel"],["type","date",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-12"],["rows","4",1,"form-control",3,"ngModelChange","ngModel"],[1,"m-0"],[1,"text-muted"],[1,"small","d-flex","gap-3"],[1,"table-responsive","mt-3"],[1,"table","table-striped","table-bordered","text-center","align-middle","mb-0"],["rowspan","2"],["colspan","2"],["colspan","14",1,"text-center","py-4","text-muted"]],template:function(t,d){t&1&&(v(0,"app-loading-screen",0),i(1,"div",1)(2,"h4",2),n(3),e(),i(4,"button",3),R("click",function(){return d.activeModal.dismiss("Cross click")}),e()(),i(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7),v(9,"hr"),i(10,"div",5)(11,"div",8)(12,"h5"),n(13,"Frecuencia"),e(),i(14,"div",9)(15,"strong"),n(16,"Kilometraje: "),e(),n(17),v(18,"br"),i(19,"strong"),n(20,"Meses: "),e(),n(21),e()(),i(22,"div",8)(23,"h5"),n(24,"Vigencia"),e(),i(25,"div",9)(26,"strong"),n(27,"Kilometraje: "),e(),n(28),v(29,"br"),i(30,"strong"),n(31,"Meses: "),e(),n(32),e()()(),v(33,"hr"),M(34,te,70,11,"div"),M(35,ne,16,3,"div",10),M(36,oe,35,36),i(37,"h5"),n(38,"Detalle operaciones"),e(),C(39,ce,9,4,"div",11,Z,!1,de,2,0,"div",12),e()()()(),i(42,"div",13)(43,"button",14),R("click",function(){return d.activeModal.close()}),n(44," Cerrar "),e()()),t&2&&(I("messageInput","Cargando...")("loading",d.cargando),r(3),s(" ",d.servicio.nombre," "),r(14),s(" ",d.formatCurrency(d.servicio.frecuencia.kilometraje||0)," "),r(4),s(" ",d.servicio.frecuencia.meses," "),r(7),s(" ",d.formatCurrency(d.servicio.vigencia.kilometraje||0)," "),r(4),s(" ",d.servicio.vigencia.meses," "),r(2),w(d.evento==="redimir"?34:-1),r(),w(d.servicio.redencion.estatus?35:-1),r(),w(d.evento==="redimir"?36:-1),r(3),h(d.servicio.detalleOperaciones))},dependencies:[B,H,j,G,O,L,P,N,q,A],encapsulation:2})};export{Y as a};
