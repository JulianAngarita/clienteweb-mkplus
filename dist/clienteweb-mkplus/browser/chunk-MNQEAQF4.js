import{a as oe}from"./chunk-VEIXSALB.js";import{a as ne}from"./chunk-3QEI6ENN.js";import{g as Y,h as ee,q as te,u as ie,v as k}from"./chunk-RRJ2G4CW.js";import{a as j,b as q,d as J,g as Q,i as $,m as Z,n as K,p as X,u as T}from"./chunk-YPYZVSIH.js";import{a as P}from"./chunk-I2A4HNRV.js";import{i as H,s as G,x as z}from"./chunk-JJK3Y3Z5.js";import{Bb as m,Db as d,Ea as c,Lb as W,Ob as r,Pb as b,Qb as S,Va as A,Vb as V,Wb as h,X as F,Xb as O,Yb as B,aa as _,fa as p,fb as R,ga as u,gb as w,hb as f,jb as I,kb as g,lb as C,mb as n,nb as i,ob as v,sb as U,tb as L,ub as E}from"./chunk-XFJKNVDY.js";import{a as D,h as N}from"./chunk-FJYW2LMB.js";var x=class a{http=_(z);servicio=`${P.api}${P.paths.versiones}`;crearVersion=t=>{try{return this.http.post(this.servicio+"/crear",t)}catch(e){return e}};consultarVersiones=t=>{try{return this.http.post(this.servicio+"/consulta",t)}catch(e){return e}};actualizarVersion=t=>{try{return this.http.post(this.servicio+"/actualizar",t)}catch(e){return e}};eliminarVersion=t=>{try{return this.http.post(this.servicio+"/eliminar",t)}catch(e){return e}};static \u0275fac=function(e){return new(e||a)};static \u0275prov=F({token:a,factory:a.\u0275fac,providedIn:"root"})};var ae=[{value:"Aire acondicionado",text:"Aire acondicionado",key:1},{value:"Cilindraje",text:"Cilindraje",key:2},{value:"Codigo equipamiento",text:"Codigo equipamiento",key:3},{value:"Espacio libre",text:"Espacio libre",key:4},{value:"Generacion vehiculo",text:"Generacion vehiculo",key:5},{value:"Modelo",text:"Modelo",key:6},{value:"Motor",text:"Motor",key:7},{value:"Numero de puertas",text:"Numero de puertas",key:8},{value:"Prefijo fabrica",text:"Prefijo fabrica",key:9},{value:"Traccion vehiculo",text:"Traccion vehiculo",key:10},{value:"Transmision",text:"Transmision",key:11},{value:"Uso vehiculo",text:"Uso vehiculo",key:12},{value:"Version codigo equipamiento",text:"Version codigo equipamiento",key:13}];function ce(a,t){if(a&1&&(n(0,"option",19),r(1),i()),a&2){let e=t.$implicit;C("value",e.value),c(),b(e.text)}}function de(a,t){if(a&1){let e=E();n(0,"tr")(1,"td"),r(2),i(),n(3,"td"),r(4),i(),n(5,"td"),r(6),i(),n(7,"td")(8,"button",29),m("click",function(){let l=p(e).$index,s=d();return u(s.eliminarCampo(l))}),v(9,"i",30),i()()()}if(a&2){let e=t.$implicit;c(2),b(e.posicion),c(2),b(e.contenido),c(2),b(e.caracteres)}}function me(a,t){if(a&1){let e=E();n(0,"div",34)(1,"div",20),v(2,"input",35),i(),n(3,"div",20),v(4,"input",35),i(),n(5,"div",20)(6,"button",29),m("click",function(){let l=p(e).$index,s=d().$implicit,y=d();return u(y.eliminarClave(s.key,l))}),r(7," Eliminar "),i()()()}if(a&2){let e=t.$implicit;c(2),C("value",e.nombre),c(2),C("value",e.valor)}}function pe(a,t){if(a&1){let e=E();n(0,"h4",15),r(1),i(),n(2,"div",7)(3,"div",8)(4,"input",31),O("ngModelChange",function(l){let s=p(e).$implicit,y=d();return h(y.tempClaves[s.key].nombre,l)||(y.tempClaves[s.key].nombre=l),u(l)}),i()(),n(5,"div",8)(6,"input",32),O("ngModelChange",function(l){let s=p(e).$implicit,y=d();return h(y.tempClaves[s.key].valor,l)||(y.tempClaves[s.key].valor=l),u(l)}),i()(),n(7,"div",33)(8,"button",24),m("click",function(){let l=p(e).$implicit,s=d();return u(s.agregarClave(l.key))}),r(9," Agregar "),i()()(),I(10,me,8,2,"div",34,f)}if(a&2){let e=t.$implicit,o=d();c(),b(e.titulo),c(3),V("ngModel",o.tempClaves[e.key].nombre),c(2),V("ngModel",o.tempClaves[e.key].valor),c(4),g(o.getDatosVersionArray(e.key))}}function ue(a,t){if(a&1){let e=E();n(0,"button",36),m("click",function(){p(e);let l=d();return u(l.actualizar())}),r(1),i()}if(a&2){let e=d();c(),S(" ",e.cargando?"Actualizando...":"Actualizar"," ")}}function _e(a,t){if(a&1){let e=E();n(0,"button",36),m("click",function(){p(e);let l=d();return u(l.guardar())}),r(1),i()}if(a&2){let e=d();c(),S(" ",e.cargando?"Guardando...":"Guardar"," ")}}var M=class a{listaSecciones=[{key:"codigoModelo",titulo:"C\xF3digo Modelo"},{key:"aireAcondicionado",titulo:"Aire Acondicionado"},{key:"codigoEquipamiento",titulo:"C\xF3digo Equipamiento"},{key:"transmision",titulo:"Transmisi\xF3n"},{key:"espacioLibre",titulo:"Espacio Libre"},{key:"generacionVehiculo",titulo:"Generaci\xF3n Veh\xEDculo"},{key:"motor",titulo:"Motor"},{key:"numeroPuertas",titulo:"N\xFAmero Puertas"},{key:"prefijoFabrica",titulo:"Prefijo f\xE1brica"},{key:"traccion",titulo:"Tracci\xF3n"},{key:"uso",titulo:"Uso"},{key:"versionCodigoEquipamiento",titulo:"Control de cambio"}];listadoContenidoVersionOpciones=ae;cargando=!1;tempCampo={contenido:"",caracteres:0,posicion:0};tempClave={nombre:"",valor:""};tempClaves={};modalActivo=_(Y);versionesService=_(x);utilidadesServices=_(k);evento="EVENTO_GUARDAR";datosVersion=Object.assign({},oe);ngOnInit(){this.listaSecciones.forEach(t=>{this.tempClaves[t.key]={nombre:"",valor:""}})}agregarCampo(){!this.tempCampo.contenido||!this.tempCampo.caracteres||!this.tempCampo.posicion||(this.datosVersion.campos.push({contenido:this.tempCampo.contenido,caracteres:this.tempCampo.caracteres,posicion:this.tempCampo.posicion}),this.tempCampo={contenido:"",caracteres:0,posicion:0})}eliminarCampo(t){this.datosVersion.campos.splice(t,1)}agregarClave(t){let e=this.tempClaves[t];!e.nombre||!e.valor||(this.getDatosVersionArray(t).push(D({},e)),this.tempClaves[t]={nombre:"",valor:""})}eliminarClave(t,e){this.getDatosVersionArray(t).splice(e,1)}getDatosVersionArray(t){let e=this.datosVersion[t];return Array.isArray(e)?e:[]}actualizar=()=>{"creado"in this.datosVersion&&delete this.datosVersion.creado,"actualizado"in this.datosVersion&&delete this.datosVersion.actualizado,"__v"in this.datosVersion&&delete this.datosVersion.__v,"editado"in this.datosVersion&&delete this.datosVersion.editado,this.cargando=!0,this.versionesService.actualizarVersion(this.datosVersion).subscribe({next:t=>{this.cargando=!1,this.utilidadesServices.abrirModalInfo("Informaci\xF3n",t.resultadoOperacion,"Aceptar"),t.estatus&&this.modalActivo.close(!0)},error:t=>{this.cargando=!1,this.utilidadesServices.abrirModalInfo("Informaci\xF3n",t.error.resultadoOperacion,"Aceptar")}})};guardar=()=>{this.cargando=!0,this.versionesService.crearVersion(this.datosVersion).subscribe({next:t=>{this.cargando=!1,this.utilidadesServices.abrirModalInfo("Informaci\xF3n",t.resultadoOperacion,"Aceptar"),t.estatus&&this.modalActivo.close(!0)},error:t=>{this.cargando=!1,this.utilidadesServices.abrirModalInfo("Informaci\xF3n",t.error.resultadoOperacion,"Aceptar")}})};static \u0275fac=function(e){return new(e||a)};static \u0275cmp=A({type:a,selectors:[["app-modal-versiones"]],inputs:{evento:"evento",datosVersion:"datosVersion"},decls:62,vars:7,consts:[["tabindex","-1","aria-modal","true","role","dialog",1,"modal","fade","show",2,"display","block"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"row","g-3"],[1,"col-md-6"],[1,"form-label"],["type","text",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-6","d-flex","align-items-center","mt-4"],[1,"form-check","form-switch"],["type","checkbox",1,"form-check-input",3,"ngModelChange","ngModel"],[1,"form-check-label","ms-2"],[1,"mt-4"],[1,"col-md-4"],["name","contenido",1,"form-select",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"col-md-3"],["type","number","name","caracteres","placeholder","Maximo 10",1,"form-control",3,"ngModelChange","ngModel"],["type","number","name","posicion","placeholder","Maximo 20",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-2","d-flex","align-items-end"],[1,"btn","btn-outline-dark","rounded-pill","px-3","d-inline-flex","align-items-center","gap-2",3,"click"],[1,"table","table-striped","mt-3"],[1,"modal-footer"],["type","button",1,"btn","boton-secondary-kia",3,"click"],["type","button",1,"btn","boton-principal-kia"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"fa","fa-trash"],["type","text","placeholder","Nombre",1,"form-control",3,"ngModelChange","ngModel"],["type","text","placeholder","Valor",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-12"],[1,"row","g-3","mt-2"],["readonly","",1,"form-control",3,"value"],["type","button",1,"btn","boton-principal-kia",3,"click"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5",4),r(5," Formulario versiones "),i(),n(6,"button",5),m("click",function(){return o.modalActivo.close(!1)}),i()(),n(7,"div",6)(8,"h3"),r(9,"Control"),i(),n(10,"div",7)(11,"div",8)(12,"label",9),r(13,"Versi\xF3n control"),i(),n(14,"input",10),O("ngModelChange",function(s){return h(o.datosVersion.versionControl,s)||(o.datosVersion.versionControl=s),s}),i()(),n(15,"div",11)(16,"div",12)(17,"input",13),O("ngModelChange",function(s){return h(o.datosVersion.activo,s)||(o.datosVersion.activo=s),s}),i(),n(18,"label",14),r(19,"Estatus de versi\xF3n"),i()()()(),n(20,"h3",15),r(21,"Campos"),i(),n(22,"div",7)(23,"div",16)(24,"label",9),r(25,"Contenido"),i(),n(26,"select",17),O("ngModelChange",function(s){return h(o.tempCampo.contenido,s)||(o.tempCampo.contenido=s),s}),n(27,"option",18),r(28,"Seleccione"),i(),I(29,ce,2,2,"option",19,f),i()(),n(31,"div",20)(32,"label",9),r(33,"Cantidad caracteres (M\xE1ximo 10)"),i(),n(34,"input",21),O("ngModelChange",function(s){return h(o.tempCampo.caracteres,s)||(o.tempCampo.caracteres=s),s}),i()(),n(35,"div",20)(36,"label",9),r(37,"Posici\xF3n (M\xE1ximo 20)"),i(),n(38,"input",22),O("ngModelChange",function(s){return h(o.tempCampo.posicion,s)||(o.tempCampo.posicion=s),s}),i()(),n(39,"div",23)(40,"button",24),m("click",function(){return o.agregarCampo()}),r(41," Agregar "),i()()(),n(42,"table",25)(43,"thead")(44,"tr")(45,"th"),r(46,"Posici\xF3n"),i(),n(47,"th"),r(48,"Contenido"),i(),n(49,"th"),r(50,"Caracteres"),i(),v(51,"th"),i()(),n(52,"tbody"),I(53,de,10,3,"tr",null,f),i()(),I(55,pe,12,3,null,null,f),i(),n(57,"div",26)(58,"button",27),m("click",function(){return o.modalActivo.close(!1)}),r(59," CANCELAR "),i(),R(60,ue,2,1,"button",28),R(61,_e,2,1,"button",28),i()()()()),e&2&&(c(14),V("ngModel",o.datosVersion.versionControl),c(3),V("ngModel",o.datosVersion.activo),c(9),V("ngModel",o.tempCampo.contenido),c(3),g(o.listadoContenidoVersionOpciones),c(5),V("ngModel",o.tempCampo.caracteres),c(4),V("ngModel",o.tempCampo.posicion),c(15),g(o.datosVersion.campos),c(2),g(o.listaSecciones),c(5),w(o.evento==="EVENTO_ACTUALIZAR"?60:-1),c(),w(o.evento==="EVENTO_GUARDAR"?61:-1))},dependencies:[T,K,X,q,$,j,Z,J,Q],encapsulation:2})};function ve(a,t){if(a&1&&(U(0),n(1,"span",22),r(2),i(),L()),a&2){let e=t.$implicit,o=t.$index,l=d(2);c(),W("background-color",l.colors[o]),C("ngbPopover",B(e.contenido)),c(),S(" ",e.caracteres," ")}}function Ce(a,t){if(a&1){let e=E();n(0,"tr")(1,"td")(2,"span",17),r(3),i()(),n(4,"td"),r(5),i(),n(6,"td"),I(7,ve,3,5,"ng-container",null,f),i(),n(9,"td")(10,"button",18),m("click",function(){let l=p(e).$implicit,s=d();return u(s.actualizar(l))}),v(11,"i",19),r(12," Editar "),i(),n(13,"button",20),m("click",function(){let l=p(e).$implicit,s=d();return u(s.eliminarVersion(l))}),v(14,"i",21),r(15," Eliminar "),i()()()}if(a&2){let e=t.$implicit;c(2),C("ngClass",e.activo?"bg-success":"bg-secondary"),c(),S(" ",e.activo?"ACTIVO":"INACTIVO"," "),c(2),b(e.versionControl),c(2),g(e.campos)}}function fe(a,t){a&1&&(n(0,"tr")(1,"td",23),r(2," No hay versiones registradas actualmente. "),i()())}var se=class a{colors=["red","orange","yellow","olive","green","teal","blue","violet","purple","pink","brown","grey","black"];cargando=!1;filtroActivo=!0;versiones=[];utilidadesService=_(k);versionesService=_(x);modalService=_(ee);eliminarVersion=t=>N(this,null,function*(){this.utilidadesService.abrirModalConfirmacion("Eliminar versi\xF3n","Estas seguro que quieres eliminar esta versi\xF3n?","Eliminar","Cancelar").then(e=>{this.eliminar(t._id??"")})});modificarFiltroActivo=()=>{this.filtroActivo=!this.filtroActivo,this.consultar()};ngOnInit(){this.consultar()}eliminar=t=>{this.cargando=!0,this.versionesService.eliminarVersion({id:t}).subscribe({next:e=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",e.resultadoOperacion,"Aceptar"),e.estatus&&this.consultar()},error:e=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",e.error.resultadoOperacion,"Aceptar")}})};crear=()=>N(this,null,function*(){let t=this.modalService.open(M,{centered:!0,size:"xl"});t.componentInstance.evento="EVENTO_GUARDAR",(yield t.result)&&this.consultar()});actualizar=t=>N(this,null,function*(){let e=this.modalService.open(M,{centered:!0,size:"xl"});e.componentInstance.evento="EVENTO_ACTUALIZAR",e.componentInstance.datosVersion=t,(yield e.result)&&this.consultar()});consultar=()=>{this.cargando=!0,this.versionesService.consultarVersiones({activo:this.filtroActivo}).subscribe({next:t=>{this.cargando=!1,t.estatus?this.versiones=t.data.versiones:this.utilidadesService.abrirModalInfo("Informaci\xF3n",t.resultadoOperacion,"Aceptar")},error:t=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",t.error.resultadoOperacion,"Aceptar")}})};static \u0275fac=function(e){return new(e||a)};static \u0275cmp=A({type:a,selectors:[["app-versiones"]],decls:37,vars:5,consts:[[3,"messageInput","loading"],[1,"container","py-5","mt-5"],[1,"d-flex","flex-column","flex-md-row","justify-content-between","align-items-md-center","mb-4"],[1,"fw-bold","text-dark","mb-1"],[1,"text-muted","mb-0"],[1,"btn","boton-principal-kia","mt-3",3,"click"],[1,"card","border-0","rounded-3","mb-4"],[1,"card-body","d-flex","flex-wrap","align-items-center","gap-3"],[1,"fw-semibold","mb-0"],[1,"form-check","form-switch","d-flex","align-items-center","gap-2"],["type","checkbox","role","switch","id","estadoModelo",1,"form-check-input",3,"change","checked"],["for","estadoModelo",1,"form-check-label","fw-medium"],[1,"card","border-0","shadow-sm","rounded-4"],[1,"table-responsive"],[1,"table","table-striped","table-hover","align-middle","mb-0"],[1,"card-footer","d-flex","justify-content-between","align-items-center"],[1,"text-muted"],[1,"badge",3,"ngClass"],[1,"btn","btn-outline-dark","rounded-pill","px-3","d-inline-flex","align-items-center","gap-2",3,"click"],[1,"fa-solid","fa-pen-to-square"],[1,"btn","btn-outline-secondary","rounded-pill","px-3","d-inline-flex","align-items-center","gap-2",3,"click"],[1,"fa-solid","fa-trash"],["popoverClass","popover-body","placement","top","triggers","hover",1,"badge","me-1",3,"ngbPopover"],["colspan","7",1,"text-center","py-4","text-muted"]],template:function(e,o){e&1&&(v(0,"app-loading-screen",0),n(1,"div",1)(2,"div",2)(3,"div")(4,"h3",3),r(5,"Versiones"),i(),n(6,"p",4),r(7," Filtra y gestiona las versiones registradas en el sistema. "),i()(),n(8,"button",5),m("click",function(){return o.crear()}),r(9,` Nueva versi\xF3n
`),i()(),n(10,"div",6)(11,"div",7)(12,"h6",8),r(13,"Filtrar por:"),i(),n(14,"div",9)(15,"input",10),m("change",function(){return o.modificarFiltroActivo()}),i(),n(16,"label",11),r(17," Estado de la versi\xF3n "),i()()()(),n(18,"div",12)(19,"div",13)(20,"table",14)(21,"thead")(22,"tr")(23,"th"),r(24,"ESTADO"),i(),n(25,"th"),r(26,"VERSION CONTROL"),i(),n(27,"th"),r(28,"CAMPOS [Caracteres]"),i(),v(29,"th"),i()(),n(30,"tbody"),I(31,Ce,16,3,"tr",null,f,!1,fe,3,0,"tr"),i()()(),n(34,"div",15)(35,"span",16),r(36),i()()()()),e&2&&(C("messageInput","Cargando...")("loading",o.cargando),c(15),C("checked",o.filtroActivo),c(16),g(o.versiones),c(5),S("Mostrando ",o.versiones.length," registros"))},dependencies:[ne,G,H,T,ie,te],encapsulation:2})};export{se as Versiones};
