import{a as re}from"./chunk-3YKSX6TR.js";import{a as ne}from"./chunk-GN2ZQHZ5.js";import{a as ae}from"./chunk-3QEI6ENN.js";import{f as $,g as ee,h as ie,p as te,u as oe,v as L}from"./chunk-RRJ2G4CW.js";import{a as K,b as D,d as V,g as P,m as Q,n as X,p as Y,u as F}from"./chunk-YPYZVSIH.js";import{a as z}from"./chunk-I2A4HNRV.js";import{s as W,x as J}from"./chunk-JJK3Y3Z5.js";import{Bb as p,Db as g,Ea as c,Mb as j,Ob as r,Pb as N,Qb as S,Rb as Z,Va as O,Vb as d,Wb as u,X as H,Xb as m,aa as b,ac as q,fa as f,fb as M,ga as _,gb as y,hb as E,ib as k,jb as v,kb as x,lb as h,mb as n,nb as o,ob as C,ub as I}from"./chunk-XFJKNVDY.js";import{a as G,h as R}from"./chunk-FJYW2LMB.js";var le={nombres:"",apellidos:""},A={email:"",nombre:Object.assign({},le),identificacion:{numero:"",tipo:""},contrasena:"",concesiones:[],activo:!1,rol:"ADMINISTRADOR SISTEMA",cargo:"",permisos:{lectura:!1,escritura:!1,eliminar:!1},grupo:""},ue={numero:""},se={email:"",nombre:Object.assign({},le),identificacion:ue,activo:!0,salto:0,limite:10,concesiones:[]};var w=class s{http=b(J);servicio=`${z.api}${z.paths.usuario}`;crearUsuario=a=>{console.log("usuario: ",a);try{return this.http.post(this.servicio+"/crear",a)}catch(e){return e}};eliminarUsuario=a=>{try{return this.http.post(this.servicio+"/eliminar",a)}catch(e){return e}};actualizarUsuario=a=>{try{return this.http.post(this.servicio+"/actualizar",a)}catch(e){return e}};consultarUsuarios=a=>{try{return this.http.post(this.servicio+"/consulta",a)}catch(e){return e}};static \u0275fac=function(e){return new(e||s)};static \u0275prov=H({token:s,factory:s.\u0275fac,providedIn:"root"})};var me=localStorage.getItem("rol"),B=[];me!=="ADMINISTRADOR CONCESIONARIO"?B=[{value:"",text:"Seleccione un rol"},{value:"ADMINISTRADOR CONCESIONARIO",text:"Administrador Concesionario"},{value:"ADMINISTRADOR SISTEMA",text:"Administrador Sistema"},{value:"ASESOR",text:"Asesor"},{value:"IMPORTADORA",text:"Importadora"}]:B=[{value:"",text:"Seleccione un rol"},{value:"ASESOR",text:"Asesor"}];function fe(s,a){if(s&1&&(n(0,"option",14),r(1),o()),s&2){let e=a.$implicit;h("value",e.value),c(),S(" ",e.text," ")}}function _e(s,a){if(s&1&&(n(0,"div",18),C(1,"i",38),r(2),o()),s&2){let e=g();c(2),S(" ",e.errorContrasena.mensaje," ")}}function Se(s,a){if(s&1&&(n(0,"option",14),r(1),o()),s&2){let e=a.$implicit;h("value",e.value),c(),S(" ",e.text," ")}}function he(s,a){if(s&1&&(n(0,"option",41),r(1),o()),s&2){let e=a.$implicit,i=g(2);h("value",e.value)("selected",e.value===i.usuarioSeleccionado.grupo),c(),S(" ",e.text," ")}}function be(s,a){if(s&1){let e=I();n(0,"li")(1,"label",46),p("click",function(l){return f(e),_(l.stopPropagation())}),n(2,"input",47),p("change",function(){let l=f(e).$implicit,t=g(2);return _(t.toggleConcesion(l.value))}),o(),r(3),o()()}if(s&2){let e=a.$implicit,i=g(2);c(2),h("checked",i.usuarioSeleccionado.concesiones.includes(e.value)),c(),S(" ",e.text," ")}}function Ce(s,a){if(s&1){let e=I();n(0,"div",20)(1,"div",39)(2,"div",15)(3,"label",10),r(4,"Grupo"),o(),n(5,"select",19),m("ngModelChange",function(l){f(e);let t=g();return u(t.usuarioSeleccionado.grupo,l)||(t.usuarioSeleccionado.grupo=l),_(l)}),p("change",function(){f(e);let l=g();return _(l.seleccionaGrupo())}),n(6,"option",40),r(7,"Seleccionar..."),o(),v(8,he,2,3,"option",41,E),o()(),n(10,"div",15)(11,"label",10),r(12,"Concesiones"),o(),n(13,"div",42)(14,"button",43)(15,"span"),r(16),o(),C(17,"i",44),o(),n(18,"ul",45),v(19,be,4,2,"li",null,k),o()()()()()}if(s&2){let e=g();c(5),d("ngModel",e.usuarioSeleccionado.grupo),c(3),x(e.grupos),c(8),S(" ",e.usuarioSeleccionado.concesiones.length," seleccionadas "),c(3),x(e.concesionesSeleccionada)}}function ve(s,a){s&1&&(n(0,"div",20)(1,"div",48)(2,"p",49),r(3,"No es necesario, este usuario tendr\xE1 acceso a todos los concesionarios"),o()()())}function xe(s,a){if(s&1&&(n(0,"option",41),r(1),o()),s&2){let e=a.$implicit,i=g(2);h("value",e.value)("selected",e.value===i.usuarioSeleccionado.grupo),c(),S(" ",e.text," ")}}function Me(s,a){if(s&1&&(n(0,"option",14),r(1),o()),s&2){let e=a.$implicit;h("value",e.value),c(),S(" ",e.text," ")}}function ye(s,a){if(s&1){let e=I();n(0,"div",20)(1,"div",39)(2,"div",15)(3,"label",10),r(4,"Grupo"),o(),n(5,"select",19),m("ngModelChange",function(l){f(e);let t=g();return u(t.usuarioSeleccionado.grupo,l)||(t.usuarioSeleccionado.grupo=l),_(l)}),p("change",function(){f(e);let l=g();return _(l.seleccionaGrupo())}),n(6,"option",40),r(7,"Seleccionar..."),o(),v(8,xe,2,3,"option",41,E),o()(),n(10,"div",15)(11,"label",10),r(12,"Concesiones"),o(),n(13,"select",13),p("ngModelChange",function(l){f(e);let t=g();return _(t.usuarioSeleccionado.concesiones=[l])}),v(14,Me,2,2,"option",14,E),o()()()()}if(s&2){let e=g();c(5),d("ngModel",e.usuarioSeleccionado.grupo),c(3),x(e.grupos),c(5),h("ngModel",e.usuarioSeleccionado.concesiones[0]),c(),x(e.concesionesSeleccionada)}}function Ie(s,a){if(s&1){let e=I();n(0,"button",50),p("click",function(){f(e);let l=g();return _(l.guardarUsuario())}),C(1,"i",51),r(2," GUARDAR "),o()}}function Ee(s,a){if(s&1){let e=I();n(0,"button",50),p("click",function(){f(e);let l=g();return _(l.actualizarUsuario())}),C(1,"i",51),r(2," ACTUALIZAR "),o()}}var T=class s{modalActivo=b(ee);usuarioService=b(w);utilidadesService=b(L);tiposIdentificacion=re;tiposRoles=B;cargando=!1;evento="EVENTO_GUARDAR";usuarioSeleccionado=Object.assign({},A);concesionarios=[];grupos=[];concesionesSeleccionada=[];contrasena={contrasena:"",confirmarContrasena:""};errorContrasena={estatus:!1,mensaje:""};ngOnInit(){console.log("grupos: ",this.grupos),console.log("concesionarios: ",this.concesionarios)}toggleConcesion(a){let e=this.usuarioSeleccionado.concesiones.indexOf(a);e===-1?this.usuarioSeleccionado.concesiones.push(a):this.usuarioSeleccionado.concesiones.splice(e,1)}seleccionaGrupo=()=>{this.usuarioSeleccionado.concesiones=[],this.concesionesSeleccionada=this.concesionarios.filter(a=>a.grupo==this.usuarioSeleccionado.grupo)};crearUsuario=()=>{this.usuarioService.crearUsuario(this.usuarioSeleccionado).subscribe({next:a=>{a.estatus?(this.utilidadesService.abrirModalInfo("Informaci\xF3n",`Usuario ${this.usuarioSeleccionado.nombre.nombres} creado con \xE9xito.`,"Aceptar"),this.usuarioSeleccionado=Object.assign({},A)):this.utilidadesService.abrirModalInfo("Informaci\xF3n","No se ha podido crear el usuario.","Aceptar"),this.contrasena={contrasena:"",confirmarContrasena:""},this.cargando=!1,this.modalActivo.close(!0)},error:a=>{this.usuarioSeleccionado=Object.assign({},A),this.utilidadesService.abrirModalInfo("Informaci\xF3n",a.error.resultadoOperacion,"Aceptar"),this.cargando=!1}})};validarContrasena(a,e){if(this.errorContrasena={estatus:!1,mensaje:""},a&&a.length<6){this.errorContrasena={estatus:!0,mensaje:"La contrase\xF1a debe tener al menos 6 caracteres"};return}a&&e&&(a!==e?this.errorContrasena={estatus:!0,mensaje:"Las contrase\xF1as no coinciden"}:this.usuarioSeleccionado.contrasena=a)}onContrasenaChange(){this.validarContrasena(this.contrasena.contrasena,this.contrasena.confirmarContrasena)}buttonActivo(){this.usuarioSeleccionado.activo=!this.usuarioSeleccionado.activo}seleccionarRol(){return this.usuarioSeleccionado.rol==="ADMINISTRADOR CONCESIONARIO"?"administrador_concesionario":this.usuarioSeleccionado.rol==="ADMINISTRADOR SISTEMA"?"administrador_sistema":this.usuarioSeleccionado.rol==="IMPORTADORA"?"importadora":"otros"}guardarUsuario(){this.errorContrasena.estatus||this.crearUsuario()}actualizarUsuario(){this.errorContrasena.estatus||(this.contrasena.contrasena&&this.contrasena.confirmarContrasena&&this.contrasena.contrasena===this.contrasena.confirmarContrasena&&(this.usuarioSeleccionado.contrasena=this.contrasena.contrasena),delete this.usuarioSeleccionado.creado,this.usuarioService.actualizarUsuario(this.usuarioSeleccionado).subscribe({next:a=>{a.estatus?(this.utilidadesService.abrirModalInfo("Informaci\xF3n",`Usuario ${this.usuarioSeleccionado.nombre.nombres} actualizado con \xE9xito.`,"Aceptar"),this.usuarioSeleccionado=Object.assign({},A)):this.utilidadesService.abrirModalInfo("Informaci\xF3n","No se ha podido actualizar el usuario.","Aceptar"),this.contrasena={contrasena:"",confirmarContrasena:""},this.cargando=!1,this.modalActivo.close(!0)},error:a=>{this.utilidadesService.abrirModalInfo("Informaci\xF3n",a.error.resultadoOperacion,"Aceptar"),this.cargando=!1}}))}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=O({type:s,selectors:[["app-modal-usuarios"]],inputs:{evento:"evento",usuarioSeleccionado:"usuarioSeleccionado",concesionarios:"concesionarios",grupos:"grupos"},decls:98,vars:23,consts:[["tabindex","-1","role","dialog","aria-modal","true",1,"modal","fade","show","d-block"],[1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content","border-0","shadow-lg"],[1,"modal-header","px-4","py-3","d-flex","align-items-center","justify-content-between","border-bottom"],[1,"fw-bold","mb-0","text-dark"],["type","button","aria-label","Cerrar",1,"btn-close",3,"click"],[1,"modal-body","px-4","py-4",2,"max-height","70vh","overflow-y","auto"],[1,"fw-semibold","mb-3","text-dark"],[1,"row","g-3","mb-4"],[1,"col-md-4"],[1,"form-label","fw-medium"],["type","text",1,"form-control",3,"ngModelChange","ngModel"],["type","email",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-select",3,"ngModelChange","ngModel"],[3,"value"],[1,"col-md-6"],["type","password","autocomplete","off","placeholder","Nueva contrase\xF1a",1,"form-control",3,"ngModelChange","ngModel"],["type","password","autocomplete","off","placeholder","Confirmar",1,"form-control",3,"ngModelChange","ngModel"],[1,"alert","alert-danger","mb-4"],[1,"form-select",3,"ngModelChange","change","ngModel"],[1,"col-12"],[1,"row","g-4"],[1,"border","rounded","p-3"],[1,"fw-medium"],[1,"form-check","form-switch"],["type","checkbox","id","usuarioActivo",1,"form-check-input",3,"ngModelChange","ngModel"],["for","usuarioActivo",1,"form-check-label"],[1,"form-check","form-switch","mb-2"],["type","checkbox","id","permisoLectura",1,"form-check-input",3,"ngModelChange","ngModel"],["for","permisoLectura",1,"form-check-label"],["type","checkbox","id","permisoEscritura",1,"form-check-input",3,"ngModelChange","ngModel"],["for","permisoEscritura",1,"form-check-label"],["type","checkbox","id","permisoEliminar",1,"form-check-input",3,"ngModelChange","ngModel"],["for","permisoEliminar",1,"form-check-label"],[1,"modal-footer","border-0","px-4","pb-4"],[1,"btn","boton-secondary-kia","px-4",3,"click"],[1,"fa-solid","fa-times","me-1"],[1,"btn","boton-principal-kia","px-4"],[1,"fa-solid","fa-exclamation-triangle","me-2"],[1,"row","g-3"],["value",""],[3,"value","selected"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown","data-bs-auto-close","false",1,"btn","border","w-100","text-start","px-3","d-flex","justify-content-between","align-items-center"],[1,"fa-solid","fa-chevron-down"],[1,"dropdown-menu","w-100","p-2",2,"max-height","250px","overflow-y","auto"],[1,"dropdown-item","d-flex","align-items-center","gap-2",3,"click"],["type","checkbox",1,"form-check-input",3,"change","checked"],[1,"alert","alert-info"],[1,"mb-0"],[1,"btn","boton-principal-kia","px-4",3,"click"],[1,"fa-solid","fa-save","me-1"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4",4),r(5," Formulario Usuarios "),o(),n(6,"button",5),p("click",function(){return i.modalActivo.close(!1)}),o()(),n(7,"div",6)(8,"h5",7),r(9,"Identificaci\xF3n"),o(),n(10,"div",8)(11,"div",9)(12,"label",10),r(13,"Nombres"),o(),n(14,"input",11),m("ngModelChange",function(t){return u(i.usuarioSeleccionado.nombre.nombres,t)||(i.usuarioSeleccionado.nombre.nombres=t),t}),o()(),n(15,"div",9)(16,"label",10),r(17,"Apellidos"),o(),n(18,"input",11),m("ngModelChange",function(t){return u(i.usuarioSeleccionado.nombre.apellidos,t)||(i.usuarioSeleccionado.nombre.apellidos=t),t}),o()(),n(19,"div",9)(20,"label",10),r(21,"Correo Electr\xF3nico"),o(),n(22,"input",12),m("ngModelChange",function(t){return u(i.usuarioSeleccionado.email,t)||(i.usuarioSeleccionado.email=t),t}),o()()(),n(23,"div",8)(24,"div",9)(25,"label",10),r(26,"Tipo de identificaci\xF3n"),o(),n(27,"select",13),m("ngModelChange",function(t){return u(i.usuarioSeleccionado.identificacion.tipo,t)||(i.usuarioSeleccionado.identificacion.tipo=t),t}),v(28,fe,2,2,"option",14,E),o()(),n(30,"div",9)(31,"label",10),r(32,"N\xFAmero de identificaci\xF3n"),o(),n(33,"input",11),m("ngModelChange",function(t){return u(i.usuarioSeleccionado.identificacion.numero,t)||(i.usuarioSeleccionado.identificacion.numero=t),t}),o()()(),n(34,"h5",7),r(35,"Contrase\xF1a"),o(),n(36,"div",8)(37,"div",15)(38,"label",10),r(39,"Contrase\xF1a"),o(),n(40,"input",16),m("ngModelChange",function(t){return u(i.contrasena.contrasena,t)||(i.contrasena.contrasena=t),t}),p("ngModelChange",function(){return i.onContrasenaChange()}),o()(),n(41,"div",15)(42,"label",10),r(43,"Confirmar contrase\xF1a"),o(),n(44,"input",17),m("ngModelChange",function(t){return u(i.contrasena.confirmarContrasena,t)||(i.contrasena.confirmarContrasena=t),t}),p("ngModelChange",function(){return i.onContrasenaChange()}),o()()(),M(45,_e,3,1,"div",18),n(46,"h5",7),r(47,"Rol"),o(),n(48,"div",8)(49,"div",15)(50,"label",10),r(51,"Cargo"),o(),n(52,"input",11),m("ngModelChange",function(t){return u(i.usuarioSeleccionado.cargo,t)||(i.usuarioSeleccionado.cargo=t),t}),o()(),n(53,"div",15)(54,"label",10),r(55,"Tipo de rol"),o(),n(56,"select",19),m("ngModelChange",function(t){return u(i.usuarioSeleccionado.rol,t)||(i.usuarioSeleccionado.rol=t),t}),p("change",function(){return i.usuarioSeleccionado.concesiones=[]}),v(57,Se,2,2,"option",14,E),o()()(),n(59,"h5",7),r(60,"Concesiones"),o(),n(61,"div",8),M(62,Ce,21,2,"div",20),M(63,ve,4,0,"div",20),M(64,ye,16,2,"div",20),o(),n(65,"div",21)(66,"div",15)(67,"h5",7),r(68,"Activaci\xF3n de Usuario"),o(),n(69,"div",22)(70,"h6",23),r(71,"Nota:"),o(),n(72,"div",24)(73,"input",25),m("ngModelChange",function(t){return u(i.usuarioSeleccionado.activo,t)||(i.usuarioSeleccionado.activo=t),t}),o(),n(74,"label",26),r(75," Si el usuario est\xE1 desactivado no estar\xE1 disponible "),o()()()(),n(76,"div",15)(77,"h5",7),r(78,"Permisos"),o(),n(79,"div",22)(80,"div",27)(81,"input",28),m("ngModelChange",function(t){return u(i.usuarioSeleccionado.permisos.lectura,t)||(i.usuarioSeleccionado.permisos.lectura=t),t}),o(),n(82,"label",29),r(83,"Lectura"),o()(),n(84,"div",27)(85,"input",30),m("ngModelChange",function(t){return u(i.usuarioSeleccionado.permisos.escritura,t)||(i.usuarioSeleccionado.permisos.escritura=t),t}),o(),n(86,"label",31),r(87,"Escritura"),o()(),n(88,"div",24)(89,"input",32),m("ngModelChange",function(t){return u(i.usuarioSeleccionado.permisos.eliminar,t)||(i.usuarioSeleccionado.permisos.eliminar=t),t}),o(),n(90,"label",33),r(91,"Eliminar"),o()()()()()(),n(92,"div",34)(93,"button",35),p("click",function(){return i.modalActivo.close(!1)}),C(94,"i",36),r(95," CANCELAR "),o(),M(96,Ie,3,0,"button",37),M(97,Ee,3,0,"button",37),o()()()()),e&2&&(c(14),d("ngModel",i.usuarioSeleccionado.nombre.nombres),c(4),d("ngModel",i.usuarioSeleccionado.nombre.apellidos),c(4),d("ngModel",i.usuarioSeleccionado.email),c(5),d("ngModel",i.usuarioSeleccionado.identificacion.tipo),c(),x(i.tiposIdentificacion),c(5),d("ngModel",i.usuarioSeleccionado.identificacion.numero),c(7),j("is-invalid",i.errorContrasena.estatus),d("ngModel",i.contrasena.contrasena),c(4),j("is-invalid",i.errorContrasena.estatus),d("ngModel",i.contrasena.confirmarContrasena),c(),y(i.errorContrasena.estatus?45:-1),c(7),d("ngModel",i.usuarioSeleccionado.cargo),c(4),d("ngModel",i.usuarioSeleccionado.rol),c(),x(i.tiposRoles),c(5),y(i.seleccionarRol()==="administrador_concesionario"?62:-1),c(),y(i.seleccionarRol()==="administrador_sistema"||i.seleccionarRol()==="importadora"?63:-1),c(),y(i.seleccionarRol()==="otros"?64:-1),c(9),d("ngModel",i.usuarioSeleccionado.activo),c(8),d("ngModel",i.usuarioSeleccionado.permisos.lectura),c(4),d("ngModel",i.usuarioSeleccionado.permisos.escritura),c(4),d("ngModel",i.usuarioSeleccionado.permisos.eliminar),c(7),y(i.evento==="EVENTO_GUARDAR"?96:-1),c(),y(i.evento==="EVENTO_ACTUALIZAR"?97:-1))},dependencies:[W,F,X,Y,D,K,Q,V,P],encapsulation:2})};var we=()=>[],Ue=(s,a)=>a._id;function Ae(s,a){s&1&&r(0," Todas las concesiones ")}function Te(s,a){if(s&1&&r(0),s&2){let e=g();S(" ",e.filtro.concesiones.length," seleccionadas ")}}function Re(s,a){if(s&1){let e=I();n(0,"li")(1,"label",28),p("click",function(l){return f(e),_(l.stopPropagation())}),n(2,"input",29),p("change",function(){let l=f(e).$implicit,t=g();return _(t.toggleConcesion(l.value))}),o(),r(3),o()()}if(s&2){let e=a.$implicit,i=g();c(2),h("checked",i.filtro.concesiones.includes(e.value)),c(),S(" ",e.text," ")}}function Oe(s,a){if(s&1){let e=I();n(0,"tr")(1,"td"),r(2),o(),n(3,"td"),r(4),o(),n(5,"td"),r(6),o(),n(7,"td"),r(8),o(),n(9,"td",30)(10,"span",31),r(11),o()(),n(12,"td",30)(13,"div",32)(14,"button",33),p("click",function(){let l=f(e).$implicit,t=g();return _(t.actualizar(l))}),C(15,"i",34),r(16," Editar "),o(),n(17,"button",35),p("click",function(){let l=f(e).$implicit,t=g();return _(t.eliminarUsuario(l))}),C(18,"i",36),r(19," Eliminar "),o()()()()}if(s&2){let e=a.$implicit;c(2),Z("",e==null||e.nombre==null?null:e.nombre.nombres," ",e==null||e.nombre==null?null:e.nombre.apellidos),c(2),N(e==null?null:e.email),c(2),N(e==null?null:e.cargo),c(2),N(e==null?null:e.rol),c(3),S(" ",((e==null?null:e.concesiones)||q(6,we)).length," ")}}function ke(s,a){s&1&&(n(0,"tr")(1,"td",37),r(2," No hay usuarios registrados actualmente. "),o()())}var de=class s{modalService=b(ie);concesionarioService=b(ne);utilidadesService=b(L);usuarioSerive=b(w);modalActivo=!1;cargandoLoader=!0;cargando=!1;modalEliminar=!1;usuarioEliminar="";evento="";usuarios=[];usuarioSeleccionado={};listaConcesionarios=[];listaGrupos=[];filtro=Object.assign({},se);total=0;pagina=1;constructor(){}ngOnInit(){this.consultar(),this.consultaConcesiones()}cambiarPagina=a=>{this.filtro.salto=(a-1)*this.filtro.limite,this.consultar()};toggleConcesion(a){let e=this.filtro.concesiones.indexOf(a);e===-1?this.filtro.concesiones.push(a):this.filtro.concesiones.splice(e,1)}consultaConcesiones(){return R(this,null,function*(){this.concesionarioService.consultarcl().subscribe({next:a=>{if(a.estatus){let e=a.data,i=[],l=[];e.map(t=>{l.push({key:t.grupo,text:t.grupo,value:t.grupo}),t.concesiones.map(U=>{i.push({grupo:t.grupo,key:`${t.grupo} ${U.nombre} ${U.cl}`,text:`${U.nombre} ${U.cl}`,value:U.cl})})}),this.listaConcesionarios=i,this.listaGrupos=l}},error:a=>{this.utilidadesService.abrirModalInfo("Informaci\xF3n",a.error.resultadoOperacio,"Aceptar")}})})}consultar=()=>{this.cargando=!0,this.usuarioSerive.consultarUsuarios(this.filtro).subscribe({next:a=>{a.estatus&&(this.usuarios=a.data.usuarios,this.total=a.data.totalUsuarios),this.cargando=!1},error:a=>{this.utilidadesService.abrirModalInfo("Informaci\xF3n",a.error.resultadoOperacion,"Aceptar"),this.cargando=!1}})};crear(){return R(this,null,function*(){let a=this.modalService.open(T,{centered:!0,size:"xl"});a.componentInstance.evento="EVENTO_GUARDAR",a.componentInstance.grupos=this.listaGrupos,a.componentInstance.concesionarios=this.listaConcesionarios,(yield a.result)&&this.consultar()})}actualizar(a){return R(this,null,function*(){let e=this.modalService.open(T,{centered:!0,size:"xl"});e.componentInstance.evento="EVENTO_ACTUALIZAR",e.componentInstance.usuarioSeleccionado=a,e.componentInstance.grupos=this.listaGrupos,e.componentInstance.concesionarios=this.listaConcesionarios,(yield e.result)&&this.consultar()})}eliminarUsuario=a=>{this.utilidadesService.abrirModalConfirmacion("Eliminar modelo",`Estas seguro que quieres eliminar el usuario ${a.nombre.nombres}?`,"Eliminar","Cancelar").then(e=>{e&&this.eliminar(a._id??"")})};eliminar=a=>{this.cargando=!0,this.usuarioSerive.eliminarUsuario({id:a}).subscribe({next:e=>{e.estatus&&this.utilidadesService.abrirModalInfo("Informaci\xF3n",e.resultadoOperacion,"Aceptar"),this.cargando=!1,this.consultar()},error:e=>{this.utilidadesService.abrirModalInfo("Informaci\xF3n",e.error.resultadoOperacion,"Aceptar"),this.cargando=!1}})};seleccionarUsuarioParaEdicion(a){this.usuarioSeleccionado=G({},a),this.evento="ACTUALIZAR",this.modalActivo=!0}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=O({type:s,selectors:[["app-usuarios"]],decls:58,vars:13,consts:[[3,"messageInput","loading"],[1,"container","py-5","mt-5"],[1,"d-flex","flex-column","flex-md-row","justify-content-between","align-items-md-center","mb-4"],[1,"fw-bold","text-dark","mb-1"],[1,"text-muted","mb-0"],[1,"btn","boton-principal-kia","mt-3",3,"click"],[1,"card","border-0","rounded-3","mb-4","shadow-sm"],[1,"card-body","d-flex","flex-wrap","align-items-center","gap-3"],[1,"fw-semibold","mb-0"],[1,"flex-grow-1",2,"min-width","220px"],["placeholder","Correo \xE9lectronico","name","textoFiltro",1,"form-control","rounded-pill","px-3",3,"ngModelChange","ngModel"],["placeholder","Nombre","name","textoFiltro",1,"form-control","rounded-pill","px-3",3,"ngModelChange","ngModel"],["placeholder","Apellidos","name","textoFiltro",1,"form-control","rounded-pill","px-3",3,"ngModelChange","ngModel"],["placeholder","N\xFAmero identificaci\xF3n","name","textoFiltro",1,"form-control","rounded-pill","px-3",3,"ngModelChange","ngModel"],[1,"dropdown",2,"min-width","400px"],["type","button","data-bs-toggle","dropdown","data-bs-auto-close","false",1,"btn","btn-light","border","rounded-pill","w-100","text-start","px-3","d-flex","justify-content-between","align-items-center"],[1,"fa-solid","fa-chevron-down"],[1,"dropdown-menu","w-100","p-2",2,"max-height","250px","overflow-y","auto"],[1,"btn","btn-outline-dark","rounded-pill","px-4",3,"click"],[1,"card","border-0","shadow-sm","rounded-4"],[1,"table-responsive"],[1,"table","align-middle","mb-0"],[1,"table-light"],[1,"fw-semibold"],[1,"fw-semibold","text-center"],[1,"card-footer","d-flex","justify-content-between","align-items-center"],[1,"text-muted"],["aria-label","Default pagination",3,"pageChange","collectionSize","pageSize","maxSize","page"],[1,"dropdown-item","d-flex","align-items-center","gap-2",3,"click"],["type","checkbox",1,"form-check-input",3,"change","checked"],[1,"text-center"],[1,"badge","bg-light","text-dark","border","rounded-pill","px-3","py-2"],[1,"d-flex","justify-content-center","gap-2"],[1,"btn","btn-outline-dark","rounded-pill","px-3","d-inline-flex","align-items-center","gap-2",3,"click"],[1,"fa-solid","fa-pen-to-square"],[1,"btn","btn-outline-secondary","rounded-pill","px-3","d-inline-flex","align-items-center","gap-2",3,"click"],[1,"fa-solid","fa-trash"],["colspan","6",1,"text-center","py-4","text-muted"]],template:function(e,i){e&1&&(C(0,"app-loading-screen",0),n(1,"div",1)(2,"div",2)(3,"div")(4,"h3",3),r(5,"Usuarios"),o(),n(6,"p",4),r(7," Gesti\xF3n y administraci\xF3n de usuarios registrados en la plataforma. "),o()(),n(8,"button",5),p("click",function(){return i.crear()}),r(9," Nuevo usuario "),o()(),n(10,"div",6)(11,"div",7)(12,"h6",8),r(13,"Filtrar por:"),o(),n(14,"div",9)(15,"input",10),m("ngModelChange",function(t){return u(i.filtro.email,t)||(i.filtro.email=t),t}),o()(),n(16,"div",9)(17,"input",11),m("ngModelChange",function(t){return u(i.filtro.nombre.nombres,t)||(i.filtro.nombre.nombres=t),t}),o()(),n(18,"div",9)(19,"input",12),m("ngModelChange",function(t){return u(i.filtro.nombre.apellidos,t)||(i.filtro.nombre.apellidos=t),t}),o()(),n(20,"div",9)(21,"input",13),m("ngModelChange",function(t){return u(i.filtro.identificacion.numero,t)||(i.filtro.identificacion.numero=t),t}),o()(),n(22,"div",14)(23,"button",15)(24,"span"),M(25,Ae,1,0)(26,Te,1,1),o(),C(27,"i",16),o(),n(28,"ul",17),v(29,Re,4,2,"li",null,k),o()(),n(31,"button",18),p("click",function(){return i.consultar()}),r(32," Buscar "),o()()(),n(33,"div",19)(34,"div",20)(35,"table",21)(36,"thead",22)(37,"tr")(38,"th",23),r(39,"Nombre"),o(),n(40,"th",23),r(41,"Correo"),o(),n(42,"th",23),r(43,"Cargo"),o(),n(44,"th",23),r(45,"Rol"),o(),n(46,"th",24),r(47,"Talleres"),o(),n(48,"th",24),r(49,"Acciones"),o()()(),n(50,"tbody"),v(51,Oe,20,7,"tr",null,Ue,!1,ke,3,0,"tr"),o()()(),n(54,"div",25)(55,"div",26),r(56),o(),n(57,"ngb-pagination",27),p("pageChange",function(t){return i.cambiarPagina(t)}),m("pageChange",function(t){return u(i.pagina,t)||(i.pagina=t),t}),o()()()()),e&2&&(h("messageInput","Cargando...")("loading",i.cargando),c(15),d("ngModel",i.filtro.email),c(2),d("ngModel",i.filtro.nombre.nombres),c(2),d("ngModel",i.filtro.nombre.apellidos),c(2),d("ngModel",i.filtro.identificacion.numero),c(4),y(i.filtro.concesiones.length===0?25:26),c(4),x(i.listaConcesionarios),c(22),x(i.usuarios),c(5),S(" Mostrando ",i.usuarios.length," usuario(s) "),c(),h("collectionSize",i.total)("pageSize",i.filtro.limite)("maxSize",10),d("page",i.pagina))},dependencies:[W,F,D,V,P,oe,te,ae,$],encapsulation:2})};export{de as Usuarios};
