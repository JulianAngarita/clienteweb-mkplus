import{a as k}from"./chunk-GN2ZQHZ5.js";import{a as Q}from"./chunk-3QEI6ENN.js";import{g as q,h as Z,p as J,u as K,v as L}from"./chunk-RRJ2G4CW.js";import{a as W,b as x,d as T,g as R,i as F,m as z,n as G,p as U,r as H,s as j,u as N}from"./chunk-YPYZVSIH.js";import"./chunk-I2A4HNRV.js";import{s as I}from"./chunk-JJK3Y3Z5.js";import{Bb as p,Db as f,Ea as l,Ob as t,Pb as g,Qb as S,Sb as B,Va as E,Vb as c,Wb as s,Xb as m,aa as C,fa as _,fb as P,ga as b,gb as V,hb as D,jb as y,kb as A,lb as h,mb as o,nb as i,ob as w,ub as M}from"./chunk-XFJKNVDY.js";import{h as O}from"./chunk-FJYW2LMB.js";var X=[{value:"AVENIDA",text:"Avenida",key:1},{value:"CALLE",text:"Calle",key:2},{value:"CARRERA",text:"Carrera",key:3},{value:"AVENIDA CARRERA",text:"Avenida carrera",key:4},{value:"AVENIDA CALLE",text:"Avenida calle",key:5},{value:"DIAGONAL",text:"Diagonal",key:6},{value:"TRANSVERSAL",text:"Transversal",key:7}];var Y={activo:!1,cl:"",nombre:"",abreviatura:"",grupo:"",tipo:"",direccion:{callePrincipal:"AVENIDA",calleSecundaria:"",numero:"",otros:"",barrio:"",ciudad:""},telefonos:{indicativoCiudad:"",numero:""},email:"",manoObra:{ordinaria:0,tmog:0}},$={nombre:"",abreviatura:"",grupo:"",tipo:"",cls:[],activo:!0,salto:0,limite:0};function te(u,r){if(u&1&&(o(0,"option",17),t(1),i()),u&2){let a=r.$implicit;h("value",a.value),l(),g(a.text)}}function ae(u,r){if(u&1){let a=M();o(0,"button",37),p("click",function(){_(a);let d=f();return b(d.actualizar())}),t(1),i()}if(u&2){let a=f();l(),S(" ",a.cargando?"Actualizando...":"Actualizar"," ")}}function re(u,r){if(u&1){let a=M();o(0,"button",37),p("click",function(){_(a);let d=f();return b(d.guardar())}),t(1),i()}if(u&2){let a=f();l(),S(" ",a.cargando?"Guardando...":"Guardar"," ")}}var v=class u{modalActivo=C(q);concesionService=C(k);utilidadesService=C(L);cargando=!1;tipoCallePrincipalOpciones=X;evento="EVENTO_GUARDAR";datosConcesion=structuredClone(Y);guardar=()=>{this.cargando=!0,this.concesionService.crearConcesionario(this.datosConcesion).subscribe({next:r=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",r.resultadoOperacion,"Aceptar"),r.estatus&&this.modalActivo.close(!0)},error:r=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",r.error.resultadoOperacion,"Aceptar")}})};actualizar=()=>{"creado"in this.datosConcesion&&delete this.datosConcesion.creado,"actualizado"in this.datosConcesion&&delete this.datosConcesion.actualizado,"__v"in this.datosConcesion&&delete this.datosConcesion.__v,"editado"in this.datosConcesion&&delete this.datosConcesion.editado,this.cargando=!0,this.concesionService.actualizarConcesionario(this.datosConcesion).subscribe({next:r=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",r.resultadoOperacion,"Aceptar"),r.estatus&&this.modalActivo.close(!0)},error:r=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",r.error.resultadoOperacion,"Aceptar")}})};static \u0275fac=function(a){return new(a||u)};static \u0275cmp=E({type:u,selectors:[["app-modal-concesion"]],inputs:{evento:"evento",datosConcesion:"datosConcesion"},decls:100,vars:19,consts:[["tabindex","-1","aria-modal","true","role","dialog",1,"modal","fade","show",2,"display","block"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mb-3"],[1,"row","g-3","mb-3"],[1,"col-md-3"],[1,"form-label"],["minlength","5","maxlength","5","name","cl",1,"form-control",3,"ngModelChange","ngModel"],["name","nombre",1,"form-control",3,"ngModelChange","ngModel"],["name","abreviatura",1,"form-control",3,"ngModelChange","ngModel"],["name","grupo",1,"form-control",3,"ngModelChange","ngModel"],["name","tipo",1,"form-control",3,"ngModelChange","ngModel"],["name","callePrincipal",1,"form-select",3,"ngModelChange","ngModel"],[3,"value"],["name","calleSecundaria",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-2"],["name","numero",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-4"],["name","otros",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-6"],["name","barrio",1,"form-control",3,"ngModelChange","ngModel"],["name","ciudad",1,"form-control",3,"ngModelChange","ngModel"],["name","indicativoCiudad",1,"form-control",3,"ngModelChange","ngModel"],["name","numeroTel",1,"form-control",3,"ngModelChange","ngModel"],["name","email",1,"form-control",3,"ngModelChange","ngModel"],["type","number","name","ordinaria",1,"form-control",3,"ngModelChange","ngModel"],["type","number","name","tmog",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-12","form-check","form-switch","d-flex","align-items-center","gap-2","ms-2"],["type","checkbox","role","switch","id","estadoConcesionario",1,"form-check-input",3,"ngModelChange","ngModel"],[1,"form-check-label","fw-medium"],[1,"modal-footer"],["type","button",1,"btn","boton-secondary-kia",3,"click"],["type","button",1,"btn","boton-principal-kia"],["type","button",1,"btn","boton-principal-kia",3,"click"]],template:function(a,n){a&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5",4),t(5," Formulario concesiones "),i(),o(6,"button",5),p("click",function(){return n.modalActivo.close(!1)}),i()(),o(7,"div",6)(8,"h6",7),t(9,"Identificaci\xF3n"),i(),o(10,"div",8)(11,"div",9)(12,"label",10),t(13,"C\xF3digo de Concesionario (cl)"),i(),o(14,"input",11),m("ngModelChange",function(e){return s(n.datosConcesion.cl,e)||(n.datosConcesion.cl=e),e}),i()(),o(15,"div",9)(16,"label",10),t(17,"Nombre"),i(),o(18,"input",12),m("ngModelChange",function(e){return s(n.datosConcesion.nombre,e)||(n.datosConcesion.nombre=e),e}),i()(),o(19,"div",9)(20,"label",10),t(21,"Abreviatura"),i(),o(22,"input",13),m("ngModelChange",function(e){return s(n.datosConcesion.abreviatura,e)||(n.datosConcesion.abreviatura=e),e}),i()(),o(23,"div",9)(24,"label",10),t(25,"Grupo"),i(),o(26,"input",14),m("ngModelChange",function(e){return s(n.datosConcesion.grupo,e)||(n.datosConcesion.grupo=e),e}),i()()(),o(27,"div",8)(28,"div",9)(29,"label",10),t(30,"Tipo"),i(),o(31,"input",15),m("ngModelChange",function(e){return s(n.datosConcesion.tipo,e)||(n.datosConcesion.tipo=e),e}),i()()(),o(32,"h6",7),t(33,"Direcci\xF3n"),i(),o(34,"div",8)(35,"div",9)(36,"label",10),t(37,"Calle Principal"),i(),o(38,"select",16),m("ngModelChange",function(e){return s(n.datosConcesion.direccion.callePrincipal,e)||(n.datosConcesion.direccion.callePrincipal=e),e}),y(39,te,2,2,"option",17,D),i()(),o(41,"div",9)(42,"label",10),t(43,"Calle Secundaria"),i(),o(44,"input",18),m("ngModelChange",function(e){return s(n.datosConcesion.direccion.calleSecundaria,e)||(n.datosConcesion.direccion.calleSecundaria=e),e}),i()(),o(45,"div",19)(46,"label",10),t(47,"N\xFAmero"),i(),o(48,"input",20),m("ngModelChange",function(e){return s(n.datosConcesion.direccion.numero,e)||(n.datosConcesion.direccion.numero=e),e}),i()(),o(49,"div",21)(50,"label",10),t(51,"Otros"),i(),o(52,"input",22),m("ngModelChange",function(e){return s(n.datosConcesion.direccion.otros,e)||(n.datosConcesion.direccion.otros=e),e}),i()()(),o(53,"div",8)(54,"div",23)(55,"label",10),t(56,"Barrio"),i(),o(57,"input",24),m("ngModelChange",function(e){return s(n.datosConcesion.direccion.barrio,e)||(n.datosConcesion.direccion.barrio=e),e}),i()(),o(58,"div",23)(59,"label",10),t(60,"Ciudad"),i(),o(61,"input",25),m("ngModelChange",function(e){return s(n.datosConcesion.direccion.ciudad,e)||(n.datosConcesion.direccion.ciudad=e),e}),i()()(),o(62,"h6",7),t(63,"Datos de Contacto"),i(),o(64,"div",8)(65,"div",9)(66,"label",10),t(67,"Indicativo de Ciudad"),i(),o(68,"input",26),m("ngModelChange",function(e){return s(n.datosConcesion.telefonos.indicativoCiudad,e)||(n.datosConcesion.telefonos.indicativoCiudad=e),e}),i()(),o(69,"div",9)(70,"label",10),t(71,"N\xFAmero"),i(),o(72,"input",27),m("ngModelChange",function(e){return s(n.datosConcesion.telefonos.numero,e)||(n.datosConcesion.telefonos.numero=e),e}),i()(),o(73,"div",23)(74,"label",10),t(75,"Correo Electr\xF3nico"),i(),o(76,"input",28),m("ngModelChange",function(e){return s(n.datosConcesion.email,e)||(n.datosConcesion.email=e),e}),i()()(),o(77,"h6",7),t(78,"Mano de Obra"),i(),o(79,"div",8)(80,"div",9)(81,"label",10),t(82,"Ordinaria"),i(),o(83,"input",29),m("ngModelChange",function(e){return s(n.datosConcesion.manoObra.ordinaria,e)||(n.datosConcesion.manoObra.ordinaria=e),e}),i()(),o(84,"div",9)(85,"label",10),t(86,"Tmog"),i(),o(87,"input",30),m("ngModelChange",function(e){return s(n.datosConcesion.manoObra.tmog,e)||(n.datosConcesion.manoObra.tmog=e),e}),i()()(),o(88,"h6",7),t(89,"Activaci\xF3n del Concesionario"),i(),o(90,"div",8)(91,"div",31)(92,"input",32),m("ngModelChange",function(e){return s(n.datosConcesion.activo,e)||(n.datosConcesion.activo=e),e}),i(),o(93,"label",33),t(94," Si el concesionario est\xE1 desactivado, no estar\xE1 disponible "),i()()()(),o(95,"div",34)(96,"button",35),p("click",function(){return n.modalActivo.close(!1)}),t(97," Cancelar "),i(),P(98,ae,2,1,"button",36),P(99,re,2,1,"button",36),i()()()()),a&2&&(l(14),c("ngModel",n.datosConcesion.cl),l(4),c("ngModel",n.datosConcesion.nombre),l(4),c("ngModel",n.datosConcesion.abreviatura),l(4),c("ngModel",n.datosConcesion.grupo),l(5),c("ngModel",n.datosConcesion.tipo),l(7),c("ngModel",n.datosConcesion.direccion.callePrincipal),l(),A(n.tipoCallePrincipalOpciones),l(5),c("ngModel",n.datosConcesion.direccion.calleSecundaria),l(4),c("ngModel",n.datosConcesion.direccion.numero),l(4),c("ngModel",n.datosConcesion.direccion.otros),l(5),c("ngModel",n.datosConcesion.direccion.barrio),l(4),c("ngModel",n.datosConcesion.direccion.ciudad),l(7),c("ngModel",n.datosConcesion.telefonos.indicativoCiudad),l(4),c("ngModel",n.datosConcesion.telefonos.numero),l(4),c("ngModel",n.datosConcesion.email),l(7),c("ngModel",n.datosConcesion.manoObra.ordinaria),l(4),c("ngModel",n.datosConcesion.manoObra.tmog),l(5),c("ngModel",n.datosConcesion.activo),l(6),V(n.evento==="EVENTO_ACTUALIZAR"?98:-1),l(),V(n.evento==="EVENTO_GUARDAR"?99:-1))},dependencies:[I,N,G,U,x,F,W,z,T,H,j,R],encapsulation:2})};var le=(u,r)=>r._id;function de(u,r){if(u&1){let a=M();o(0,"tr")(1,"td"),t(2),i(),o(3,"td"),t(4),i(),o(5,"td"),t(6),i(),o(7,"td"),t(8),i(),o(9,"td"),t(10),i(),o(11,"td"),t(12),i(),o(13,"td"),t(14),i(),o(15,"td",22)(16,"button",26),p("click",function(){let d=_(a).$implicit,e=f();return b(e.actualizar(d))}),w(17,"i",27),t(18," Editar "),i(),o(19,"button",28),p("click",function(){let d=_(a).$implicit,e=f();return b(e.eliminarConcesion(d))}),w(20,"i",29),t(21," Eliminar "),i()()()}if(u&2){let a=r.$implicit;l(2),g(a.cl),l(2),g(a.nombre),l(2),g(a.abreviatura),l(2),B("",a.direccion.callePrincipal," ",a.direccion.calleSecundaria," ",a.direccion.numero),l(2),g(a.direccion.ciudad),l(2),g(a.grupo),l(2),g(a.activo?"S\xED":"No")}}function ce(u,r){u&1&&(o(0,"tr")(1,"td",30),t(2," No hay concesiones registrados actualmente. "),i()())}var ee=class u{concesionService=C(k);utilidadesService=C(L);modalService=C(Z);total=0;pagina=1;cargando=!1;concesiones=[];filtroConcesion=structuredClone($);ngOnInit(){this.consultar()}cambiarPagina=r=>{this.filtroConcesion.salto=(r-1)*this.filtroConcesion.limite,this.consultar()};consultar=()=>{this.cargando=!0,this.concesionService.consultarConcesionarios(this.filtroConcesion).subscribe({next:r=>{this.cargando=!1,r.estatus?(this.concesiones=r.data.concesiones,this.total=r.data.total):this.utilidadesService.abrirModalInfo("Informaci\xF3n",r.resultadoOperacion,"Aceptar")},error:r=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",r.error.resultadoOperacion,"Aceptar")}})};actualizar=r=>O(this,null,function*(){let a=this.modalService.open(v,{centered:!0,size:"xxl"});a.componentInstance.evento="EVENTO_ACTUALIZAR",a.componentInstance.datosConcesion=r,(yield a.result)&&this.consultar()});crear=()=>O(this,null,function*(){let r=this.modalService.open(v,{centered:!0,size:"xxl"});r.componentInstance.evento="EVENTO_GUARDAR",(yield r.result)&&this.consultar()});eliminarConcesion=r=>{this.utilidadesService.abrirModalConfirmacion("Eliminar concesion",`Estas seguro que quieres eliminar la concesion ${r.grupo} ${r.nombre} ${r.cl}`,"Eliminar","Cancelar").then(a=>{a&&this.eliminar(r._id??"")})};eliminar=r=>{this.cargando=!0,this.concesionService.eliminarConcesionario({id:r}).subscribe({next:a=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",a.resultadoOperacion,"Aceptar"),a.estatus&&this.consultar()},error:a=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",a.error.resultadoOperacion,"Aceptar")}})};static \u0275fac=function(a){return new(a||u)};static \u0275cmp=E({type:u,selectors:[["app-concesiones"]],decls:58,vars:13,consts:[[3,"messageInput","loading"],[1,"container","py-5","mt-5"],[1,"d-flex","flex-column","flex-md-row","justify-content-between","align-items-md-center","mb-4"],[1,"fw-bold","text-dark","mb-1"],[1,"text-muted","mb-0"],[1,"btn","boton-principal-kia",3,"click"],[1,"card","border-0","rounded-3","mb-4","shadow-sm"],[1,"card-body","d-flex","flex-wrap","align-items-center","gap-3"],[1,"fw-semibold","mb-0"],[1,"flex-grow-1",2,"min-width","220px"],["placeholder","Nombre",1,"form-control","rounded-pill","px-3",3,"ngModelChange","ngModel"],["placeholder","Abreviatura",1,"form-control","rounded-pill","px-3",3,"ngModelChange","ngModel"],["placeholder","Descripci\xF3n",1,"form-control","rounded-pill","px-3",3,"ngModelChange","ngModel"],["placeholder","PNC",1,"form-control","rounded-pill","px-3",3,"ngModelChange","ngModel"],[1,"form-check","form-switch","d-flex","align-items-center","gap-2"],["type","checkbox","role","switch","id","estadoModelo",1,"form-check-input",3,"ngModelChange","ngModel"],["for","estadoModelo",1,"form-check-label","fw-medium"],[1,"btn","btn-outline-dark","rounded-pill","px-4",3,"click"],[1,"card","border-0","shadow-sm","rounded-4"],[1,"table-responsive"],[1,"table","align-middle","mb-0"],[1,"table-light"],[1,"text-center"],[1,"card-footer","d-flex","justify-content-between","align-items-center"],[1,"text-muted"],["aria-label","Default pagination",3,"pageChange","collectionSize","pageSize","maxSize","page"],[1,"btn","btn-outline-dark","rounded-pill","px-3","me-2","d-inline-flex","align-items-center","gap-1",3,"click"],[1,"fa-solid","fa-pen-to-square"],[1,"btn","btn-outline-secondary","rounded-pill","px-3","me-2","d-inline-flex","align-items-center","gap-1",3,"click"],[1,"fa-solid","fa-trash"],["colspan","8",1,"text-center","py-4","text-muted"]],template:function(a,n){a&1&&(w(0,"app-loading-screen",0),o(1,"div",1)(2,"div",2)(3,"div")(4,"h3",3),t(5,"Concesiones"),i(),o(6,"p",4),t(7," Gesti\xF3n y control de los concesionarios registrados en la plataforma. "),i()(),o(8,"button",5),p("click",function(){return n.crear()}),t(9," Nuevo concesionario "),i()(),o(10,"div",6)(11,"div",7)(12,"h6",8),t(13,"Filtrar por:"),i(),o(14,"div",9)(15,"input",10),m("ngModelChange",function(e){return s(n.filtroConcesion.nombre,e)||(n.filtroConcesion.nombre=e),e}),i()(),o(16,"div",9)(17,"input",11),m("ngModelChange",function(e){return s(n.filtroConcesion.abreviatura,e)||(n.filtroConcesion.abreviatura=e),e}),i()(),o(18,"div",9)(19,"input",12),m("ngModelChange",function(e){return s(n.filtroConcesion.grupo,e)||(n.filtroConcesion.grupo=e),e}),i()(),o(20,"div",9)(21,"input",13),m("ngModelChange",function(e){return s(n.filtroConcesion.tipo,e)||(n.filtroConcesion.tipo=e),e}),i()(),o(22,"div",9)(23,"div",14)(24,"input",15),m("ngModelChange",function(e){return s(n.filtroConcesion.activo,e)||(n.filtroConcesion.activo=e),e}),i(),o(25,"label",16),t(26," Estado de la concesion "),i()()(),o(27,"button",17),p("click",function(){return n.consultar()}),t(28," Buscar "),i()()(),o(29,"div",18)(30,"div",19)(31,"table",20)(32,"thead",21)(33,"tr")(34,"th"),t(35,"CL"),i(),o(36,"th"),t(37,"NOMBRE"),i(),o(38,"th"),t(39,"ABREVIATURA"),i(),o(40,"th"),t(41,"DIRECCION"),i(),o(42,"th"),t(43,"CIUDAD"),i(),o(44,"th"),t(45,"GRUPO"),i(),o(46,"th"),t(47,"ACTIVO"),i(),o(48,"th",22),t(49,"ACCIONES"),i()()(),o(50,"tbody"),y(51,de,22,9,"tr",null,le,!1,ce,3,0,"tr"),i()()(),o(54,"div",23)(55,"div",24),t(56),i(),o(57,"ngb-pagination",25),p("pageChange",function(e){return n.cambiarPagina(e)}),m("pageChange",function(e){return s(n.pagina,e)||(n.pagina=e),e}),i()()()()),a&2&&(h("messageInput","Cargando...")("loading",n.cargando),l(15),c("ngModel",n.filtroConcesion.nombre),l(2),c("ngModel",n.filtroConcesion.abreviatura),l(2),c("ngModel",n.filtroConcesion.grupo),l(2),c("ngModel",n.filtroConcesion.tipo),l(3),c("ngModel",n.filtroConcesion.activo),l(27),A(n.concesiones),l(5),S(" Mostrando ",n.concesiones.length," respuesto(s) "),l(),h("collectionSize",n.total)("pageSize",n.filtroConcesion.limite)("maxSize",10),c("page",n.pagina))},dependencies:[N,x,W,T,R,I,Q,K,J],encapsulation:2})};export{ee as Concesiones};
