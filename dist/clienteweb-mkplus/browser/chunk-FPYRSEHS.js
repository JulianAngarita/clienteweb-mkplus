import{b as X}from"./chunk-FDIU7H7T.js";import{a as Q}from"./chunk-YQHSFYFW.js";import"./chunk-VGJAMV7Y.js";import{a as K}from"./chunk-OK34JCII.js";import{a as G}from"./chunk-3QEI6ENN.js";import{p as j,u as U,v as J}from"./chunk-Z5HBHXP3.js";import{b as F,d as O,g as P,m as R,n as B,o as z,p as q,u as H}from"./chunk-YPYZVSIH.js";import"./chunk-I2A4HNRV.js";import{f as V,i as D}from"./chunk-PTR2WAUU.js";import{n as k,s as N}from"./chunk-JJK3Y3Z5.js";import{Bb as y,Db as s,Ea as d,Ob as a,Pb as E,Qb as u,Va as T,Vb as m,Wb as p,Xb as S,aa as x,bc as L,fa as f,fb as M,fc as I,ga as _,gb as v,hb as W,hc as w,jb as h,kb as C,lb as g,mb as i,nb as t,ob as A,ub as b}from"./chunk-XFJKNVDY.js";import"./chunk-FJYW2LMB.js";var $=r=>["/admin/nueva-solicitud",r],Z=(r,l)=>l.value;function ee(r,l){if(r&1){let e=b();i(0,"input",23),S("ngModelChange",function(c){f(e);let o=s();return p(o.filtroSolicitudes.solicitud.concesionario,c)||(o.filtroSolicitudes.solicitud.concesionario=c),_(c)}),t()}if(r&2){let e=s();m("ngModel",e.filtroSolicitudes.solicitud.concesionario)}}function ie(r,l){if(r&1&&(i(0,"option",16),a(1),t()),r&2){let e=l.$implicit;g("value",e.value),d(),E(e.text)}}function te(r,l){if(r&1){let e=b();i(0,"select",24),S("ngModelChange",function(c){f(e);let o=s();return p(o.filtroSolicitudes.solicitud.concesionario,c)||(o.filtroSolicitudes.solicitud.concesionario=c),_(c)}),h(1,ie,2,2,"option",16,Z),t()}if(r&2){let e=s();m("ngModel",e.filtroSolicitudes.solicitud.concesionario),d(),C(e.opcionesConcesiones)}}function ne(r,l){if(r&1&&(i(0,"option",16),a(1),t()),r&2){let e=l.$implicit;g("value",e.value),d(),E(e.text)}}function oe(r,l){if(r&1){let e=b();i(0,"div",26)(1,"button",28),a(2," Ver "),t(),i(3,"button",29),y("click",function(){f(e);let c=s().$implicit,o=s();return _(o.eliminar(c))}),a(4," Eliminar "),t()()}if(r&2){let e=s().$implicit;d(),g("routerLink",L(1,$,e._id))}}function le(r,l){r&1&&(i(0,"button",27),a(1," Ver "),t())}function ae(r,l){if(r&1&&(i(0,"tr")(1,"td"),a(2),I(3,"date"),t(),i(4,"td"),a(5),I(6,"date"),t(),i(7,"td"),a(8),t(),i(9,"td"),a(10),t(),i(11,"td"),a(12),t(),i(13,"td"),a(14),t(),i(15,"td"),a(16),t(),i(17,"td"),a(18),t(),i(19,"td",25),M(20,oe,5,3,"div",26)(21,le,2,0,"button",27),t()()),r&2){let e=l.$implicit,n=s();d(2),u(" ",w(3,9,e.creado,"dd-MM-yyyy hh:mm a")," "),d(3),u(" ",w(6,12,e.actualizado,"dd-MM-yyyy hh:mm a")," "),d(3),u(" ",e.solicitud.numero," "),d(2),u(" ",e.concesionario.cl," "),d(2),u(" ",e.solicitud.vin," "),d(2),u(" ",e.detallesCliente.identificacion.tipo," "),d(2),u(" ",e.detallesCliente.identificacion.numero," "),d(2),u(" ",e.estado," "),d(2),v(n.rol==="ADMINISTRADOR SISTEMA"?20:21)}}function re(r,l){r&1&&(i(0,"tr")(1,"td",30),a(2," No hay solicitudes registrados actualmente. "),t()())}var Y=class r{solicitudesService=x(Q);utilidadesService=x(J);pagina=1;total=0;cargando=!1;filtroSolicitudes=structuredClone(X);solicitudes=[];usuario=localStorage.getItem("usuario");rol="";opcionesConcesiones=[];estadoSolicitudesListaOpciones=K;constructor(){let l=JSON.parse(this.usuario??""),e=[];l&&(this.rol=l.rol,l.concesiones.map(n=>e.push({value:n,text:n,key:n})),this.opcionesConcesiones=e),this.consulta()}cambiarPagina=l=>{this.filtroSolicitudes.salto=(l-1)*this.filtroSolicitudes.limite,this.consulta()};consulta=()=>{this.cargando=!0,this.solicitudesService.consultaListaSolicitudes(this.filtroSolicitudes).subscribe({next:l=>{this.cargando=!1,l.estatus?(this.solicitudes=l.data.solicitudes,this.total=l.data.total):this.utilidadesService.abrirModalInfo("Informaci\xF3n",l.resultadoOperacion,"Aceptar")},error:l=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",l.error.resultadoOperacion,"Aceptar")}})};eliminar=l=>{this.utilidadesService.abrirModalConfirmacion("Eliminar solicitud",`Estas seguro que quieres eliminar la solicitud ${l.solicitud.numero}`,"Eliminar","Cancelar").then(e=>{e&&this.eliminarSolicitud(l._id??"")})};eliminarSolicitud=l=>{this.cargando=!0,this.solicitudesService.eliminarSolicitud({id:l}).subscribe({next:e=>{this.cargando=!1,e.estatus?this.consulta():this.utilidadesService.abrirModalInfo("Informaci\xF3n",e.resultadoOperacion,"Aceptar")},error:e=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",e.error.resultadoOperacion,"Aceptar")}})};static \u0275fac=function(e){return new(e||r)};static \u0275cmp=T({type:r,selectors:[["app-solicitudes"]],decls:63,vars:12,consts:[[3,"messageInput","loading"],[1,"container","my-5","py-5",2,"min-height","70vh"],[1,"display-4","mt-4","mb-4","d-flex","justify-content-between"],["routerLink","/admin/nueva-solicitud/id",1,"btn","boton-secondary-kia"],[1,"card","mt-2"],[1,"card-body"],[1,"row"],[1,"col-md-4"],["placeholder","Concesionario","name","concesionario",1,"form-control",3,"ngModel"],["multiple","","name","concesionario",1,"form-select",3,"ngModel"],["placeholder","N\xFAmero de solicitud","name","numero",1,"form-control",3,"ngModelChange","ngModel"],["placeholder","VIN","name","vin",1,"form-control",3,"ngModelChange","ngModel"],[1,"row","mt-3"],["type","date","name","desde",1,"form-control",3,"ngModelChange","ngModel"],["type","date","name","hasta",1,"form-control",3,"ngModelChange","ngModel"],["name","estado",1,"form-select",3,"ngModelChange","ngModel"],[3,"value"],[1,"mt-3"],[1,"btn","boton-secondary-kia",3,"click"],[1,"table-responsive","mt-3","mb-3"],[1,"table","table-sm","table-bordered","text-center","align-middle"],[1,"table-light"],[3,"pageChange","collectionSize","pageSize","page"],["placeholder","Concesionario","name","concesionario",1,"form-control",3,"ngModelChange","ngModel"],["multiple","","name","concesionario",1,"form-select",3,"ngModelChange","ngModel"],[1,"text-center"],[1,"d-flex","justify-content-center","gap-3"],[1,"btn","btn-outline-dark","rounded-pill","px-3","d-inline-flex","align-items-center","gap-2"],[1,"btn","btn-outline-dark","rounded-pill","px-3","d-inline-flex","align-items-center","gap-2",3,"routerLink"],[1,"btn","btn-outline-dark","rounded-pill","px-3","d-inline-flex","align-items-center","gap-2",3,"click"],["colspan","9",1,"text-center","py-4","text-muted"]],template:function(e,n){e&1&&(A(0,"app-loading-screen",0),i(1,"div",1)(2,"h1",2),a(3," Solicitudes "),i(4,"a",3),a(5," Nueva solicitud "),t()(),i(6,"div",4)(7,"div",5)(8,"h5"),a(9,"Filtrar por"),t(),i(10,"div",6)(11,"div",7),M(12,ee,1,1,"input",8)(13,te,3,1,"select",9),t(),i(14,"div",7)(15,"input",10),S("ngModelChange",function(o){return p(n.filtroSolicitudes.solicitud.numero,o)||(n.filtroSolicitudes.solicitud.numero=o),o}),t()(),i(16,"div",7)(17,"input",11),S("ngModelChange",function(o){return p(n.filtroSolicitudes.solicitud.vin,o)||(n.filtroSolicitudes.solicitud.vin=o),o}),t()()(),i(18,"div",12)(19,"div",7)(20,"label"),a(21,"Desde"),t(),i(22,"input",13),S("ngModelChange",function(o){return p(n.filtroSolicitudes.fecha.desde,o)||(n.filtroSolicitudes.fecha.desde=o),o}),t()(),i(23,"div",7)(24,"label"),a(25,"Hasta"),t(),i(26,"input",14),S("ngModelChange",function(o){return p(n.filtroSolicitudes.fecha.hasta,o)||(n.filtroSolicitudes.fecha.hasta=o),o}),t()(),i(27,"div",7)(28,"label"),a(29,"Estado"),t(),i(30,"select",15),S("ngModelChange",function(o){return p(n.filtroSolicitudes.estado,o)||(n.filtroSolicitudes.estado=o),o}),h(31,ne,2,2,"option",16,Z),t()()(),i(33,"div",17)(34,"button",18),y("click",function(){return n.consulta()}),a(35," Buscar "),t()()()(),i(36,"div",19)(37,"table",20)(38,"thead",21)(39,"tr")(40,"th"),a(41,"Creado"),t(),i(42,"th"),a(43,"\xDAltima actualizaci\xF3n"),t(),i(44,"th"),a(45,"N\xFAmero de solicitud"),t(),i(46,"th"),a(47,"Distribuidor"),t(),i(48,"th"),a(49,"VIN"),t(),i(50,"th"),a(51,"Tipo ID cliente"),t(),i(52,"th"),a(53,"ID cliente"),t(),i(54,"th"),a(55,"Estado"),t(),i(56,"th"),a(57,"Ver"),t()()(),i(58,"tbody"),h(59,ae,22,15,"tr",null,W,!1,re,3,0,"tr"),t()()(),i(62,"ngb-pagination",22),S("pageChange",function(o){return p(n.pagina,o)||(n.pagina=o),o}),y("pageChange",function(o){return n.cambiarPagina(o)}),t()()),e&2&&(g("messageInput","Cargando...")("loading",n.cargando),d(12),v(n.rol==="ADMINISTRADOR SISTEMA"||n.rol==="IMPORTADORA"?12:13),d(3),m("ngModel",n.filtroSolicitudes.solicitud.numero),d(2),m("ngModel",n.filtroSolicitudes.solicitud.vin),d(5),m("ngModel",n.filtroSolicitudes.fecha.desde),d(4),m("ngModel",n.filtroSolicitudes.fecha.hasta),d(4),m("ngModel",n.filtroSolicitudes.estado),d(),C(n.estadoSolicitudesListaOpciones),d(28),C(n.solicitudes),d(3),g("collectionSize",n.total)("pageSize",10),m("page",n.pagina))},dependencies:[H,B,q,F,R,z,O,P,N,U,j,G,D,V,k],encapsulation:2})};export{Y as Solicitudes};
