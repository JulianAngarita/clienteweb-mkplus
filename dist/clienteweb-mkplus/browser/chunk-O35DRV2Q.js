import{a as Z}from"./chunk-3QEI6ENN.js";import{g as G,h as B,v as C}from"./chunk-Z5HBHXP3.js";import{b as V,d as W,e as U,f as F,g as L,h as z,i as H,u as j}from"./chunk-YPYZVSIH.js";import{a as A}from"./chunk-I2A4HNRV.js";import{s as y,x as D}from"./chunk-JJK3Y3Z5.js";import{Bb as m,Db as f,Ea as l,Ob as o,Pb as b,Qb as O,Va as E,Vb as h,Wb as T,X as w,Xb as v,aa as p,fa as c,fb as M,ga as u,gb as x,jb as R,kb as k,lb as N,mb as i,nb as a,ob as g,ub as S}from"./chunk-XFJKNVDY.js";import{h as P}from"./chunk-FJYW2LMB.js";var _=class s{http=p(D);servicio=`${A.api}${A.paths.temparioPrepagado}`;consultarTempariosPrepagado=()=>{try{return this.http.post(this.servicio+"/consulta",{})}catch(e){return e}};crearTemparioPrepagado=e=>{try{return this.http.post(this.servicio+"/crear",e)}catch(t){return t}};actualizarTemparioPrepagado=e=>{try{return this.http.post(this.servicio+"/actualizar",e)}catch(t){return t}};eliminarTemparioPrepagado=e=>{try{return this.http.post(this.servicio+"/eliminar",e)}catch(t){return t}};static \u0275fac=function(t){return new(t||s)};static \u0275prov=w({token:s,factory:s.\u0275fac,providedIn:"root"})};var J={rutina:0,descuentos:{repuestosImportadora:0,repuestosConcesionario:0,totalDescuento:0},hora:0};function X(s,e){if(s&1){let t=S();i(0,"button",19),m("click",function(){c(t);let d=f();return u(d.actualizar())}),o(1," ACTUALIZAR "),a()}}function Y(s,e){if(s&1){let t=S();i(0,"button",19),m("click",function(){c(t);let d=f();return u(d.crear())}),o(1," GUARDAR "),a()}}var I=class s{modalActivo=p(G);utilidadesService=p(C);tempariosPrepagadoService=p(_);cargando=!1;evento="EVENTO_GUARDAR";datosTempario=structuredClone(J);crear=()=>{this.cargando=!0,this.tempariosPrepagadoService.crearTemparioPrepagado(this.datosTempario).subscribe({next:e=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",e.resultadoOperacion,"Aceptar"),this.modalActivo.close(e.estatus)},error:e=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",e.error.resultadoOperacion,"Aceptar")}})};actualizar=()=>{"creado"in this.datosTempario&&delete this.datosTempario.creado,"actualizado"in this.datosTempario&&delete this.datosTempario.actualizado,"__v"in this.datosTempario&&delete this.datosTempario.__v,"editado"in this.datosTempario&&delete this.datosTempario.editado,this.cargando=!0,this.tempariosPrepagadoService.actualizarTemparioPrepagado(this.datosTempario).subscribe({next:e=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",e.resultadoOperacion,"Aceptar"),this.modalActivo.close(e.estatus)},error:e=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",e.error.resultadoOperacion,"Aceptar")}})};static \u0275fac=function(t){return new(t||s)};static \u0275cmp=E({type:s,selectors:[["app-modal-tempario-prepagado"]],inputs:{evento:"evento",datosTempario:"datosTempario"},decls:40,vars:7,consts:[["tabindex","-1","aria-modal","true","role","dialog",1,"modal","fade","show",2,"display","block"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"mb-3"],[1,"row","g-3","mb-3"],[1,"col-md-6"],[1,"form-label"],["name","nombre",1,"form-control",3,"ngModelChange","ngModel"],["name","codigoModelo",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-4"],["type","number","name","insumos",1,"form-control",3,"ngModelChange","ngModel"],["type","number","name","manoObra",1,"form-control",3,"ngModelChange","ngModel"],[1,"modal-footer"],["type","button",1,"btn","boton-secondary-kia",3,"click"],["type","button",1,"btn","boton-principal-kia"],["type","button",1,"btn","boton-principal-kia",3,"click"]],template:function(t,r){t&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5",4),o(5,"Formulario Temparios"),a(),g(6,"button",5),a(),i(7,"div",6)(8,"form")(9,"h6",7),o(10,"Datos de la rutina"),a(),i(11,"div",8)(12,"div",9)(13,"label",10),o(14,"Rutina"),a(),i(15,"input",11),v("ngModelChange",function(n){return T(r.datosTempario.rutina,n)||(r.datosTempario.rutina=n),n}),a()(),i(16,"div",9)(17,"label",10),o(18,"Horas"),a(),i(19,"input",12),v("ngModelChange",function(n){return T(r.datosTempario.hora,n)||(r.datosTempario.hora=n),n}),a()()(),i(20,"h6",7),o(21,"Descuentos"),a(),i(22,"div",8)(23,"div",13)(24,"label",10),o(25,"Repuestos de importadora"),a(),i(26,"input",14),v("ngModelChange",function(n){return T(r.datosTempario.descuentos.repuestosImportadora,n)||(r.datosTempario.descuentos.repuestosImportadora=n),n}),a()(),i(27,"div",13)(28,"label",10),o(29,"Repuestos de concesionario"),a(),i(30,"input",15),v("ngModelChange",function(n){return T(r.datosTempario.descuentos.repuestosConcesionario,n)||(r.datosTempario.descuentos.repuestosConcesionario=n),n}),a()(),i(31,"div",13)(32,"label",10),o(33,"Total descuento"),a(),i(34,"input",15),v("ngModelChange",function(n){return T(r.datosTempario.descuentos.totalDescuento,n)||(r.datosTempario.descuentos.totalDescuento=n),n}),a()()()()(),i(35,"div",16)(36,"button",17),m("click",function(){return r.modalActivo.close(!1)}),o(37," CANCELAR "),a(),M(38,X,2,0,"button",18),M(39,Y,2,0,"button",18),a()()()()),t&2&&(l(15),h("ngModel",r.datosTempario.rutina),l(4),h("ngModel",r.datosTempario.hora),l(7),h("ngModel",r.datosTempario.descuentos.repuestosImportadora),l(4),h("ngModel",r.datosTempario.descuentos.repuestosConcesionario),l(4),h("ngModel",r.datosTempario.descuentos.totalDescuento),l(4),x(r.evento==="EVENTO_ACTUALIZAR"?38:-1),l(),x(r.evento==="EVENTO_GUARDAR"?39:-1))},dependencies:[y,j,z,V,H,W,U,L,F],encapsulation:2})};var $=(s,e)=>e._id;function ee(s,e){if(s&1){let t=S();i(0,"tr")(1,"td"),o(2),a(),i(3,"td"),o(4),a(),i(5,"td"),o(6),a(),i(7,"td"),o(8),a(),i(9,"td"),o(10),a(),i(11,"td",10)(12,"div",15)(13,"button",16),m("click",function(){let d=c(t).$implicit,n=f();return u(n.actualizar(d))}),g(14,"i",17),o(15," Editar "),a(),i(16,"button",18),m("click",function(){let d=c(t).$implicit,n=f();return u(n.eliminarTempario(d))}),g(17,"i",19),o(18," Eliminar "),a()()()()}if(s&2){let t=e.$implicit;l(2),b(t.descuentos.repuestosImportadora),l(2),b(t.descuentos.repuestosConcesionario),l(2),b(t.descuentos.totalDescuento),l(2),b(t.rutina),l(2),b(t.hora)}}function te(s,e){s&1&&(i(0,"tr")(1,"td",20),o(2," No hay temparios registrados actualmente. "),a()())}var K=class s{temparioPrepagadoService=p(_);utilidadesService=p(C);modalService=p(B);cargando=!1;temparios=[];ngOnInit(){this.consultar()}consultar=()=>{this.cargando=!0,this.temparioPrepagadoService.consultarTempariosPrepagado().subscribe({next:e=>{this.cargando=!1,e.estatus?this.temparios=e.data:this.utilidadesService.abrirModalInfo("Informaci\xF3n",e.resultadoOperacion,"Aceptar")},error:e=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",e.error.resultadoOperacion,"Aceptar")}})};crear=()=>P(this,null,function*(){let e=this.modalService.open(I,{centered:!0});e.componentInstance.evento="EVENTO_GUARDAR",(yield e.result)&&this.consultar()});actualizar=e=>P(this,null,function*(){let t=this.modalService.open(I,{centered:!0});t.componentInstance.evento="EVENTO_ACTUALIZAR",t.componentInstance.datosTempario=e,(yield t.result)&&this.consultar()});eliminarTempario=e=>{this.utilidadesService.abrirModalConfirmacion("Eliminar Tempario prepagado",`Estas seguro que quieres eliminar el tempario ${e.rutina}?`,"Eliminar","Cancelar").then(t=>{this.eliminar(e._id??"")})};eliminar=e=>{this.cargando=!0,this.temparioPrepagadoService.eliminarTemparioPrepagado({id:e}).subscribe({next:t=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",t.resultadoOperacion,"Aceptar"),t.estatus&&this.consultar()},error:t=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",t.error.resultadoOperacion,"Aceptar")}})};static \u0275fac=function(t){return new(t||s)};static \u0275cmp=E({type:s,selectors:[["app-temparios-prepagado"]],decls:37,vars:4,consts:[[3,"messageInput","loading"],[1,"container","py-5","mt-5"],[1,"d-flex","flex-column","flex-md-row","justify-content-between","align-items-md-center","mb-4"],[1,"fw-bold","text-dark","mb-1"],[1,"text-muted","mb-0"],[1,"btn","boton-principal-kia","mt-3",3,"click"],[1,"card","border-0","shadow-sm","rounded-4"],[1,"table-responsive"],[1,"table","align-middle","table-striped","mb-0"],[1,"table-light"],[1,"text-center"],["colspan","3"],["rowspan","2"],[1,"card-footer","d-flex","justify-content-between","align-items-center"],[1,"text-muted"],[1,"d-flex","justify-content-center","gap-2"],[1,"btn","btn-outline-dark","rounded-pill","px-3","d-inline-flex","align-items-center","gap-2",3,"click"],[1,"fa-solid","fa-pen-to-square"],[1,"btn","btn-outline-secondary","rounded-pill","px-3","d-inline-flex","align-items-center","gap-2",3,"click"],[1,"fa-solid","fa-trash"],["colspan","8",1,"text-center","py-4","text-muted"]],template:function(t,r){t&1&&(g(0,"app-loading-screen",0),i(1,"div",1)(2,"div",2)(3,"div")(4,"h3",3),o(5,"Temparios"),a(),i(6,"p",4),o(7," Gesti\xF3n y administraci\xF3n de temparios registrados. "),a()(),i(8,"button",5),m("click",function(){return r.crear()}),o(9," Nueva rutina "),a()(),i(10,"div",6)(11,"div",7)(12,"table",8)(13,"thead",9)(14,"tr",10)(15,"th",11),o(16,"DESCUENTOS"),a(),i(17,"th",12),o(18,"RUTINA"),a(),i(19,"th",12),o(20,"HORAS"),a(),i(21,"th",12),o(22,"ACCIONES"),a()(),i(23,"tr")(24,"th"),o(25,"Repuestos Importadora"),a(),i(26,"th"),o(27,"Repuestos Concesionario"),a(),i(28,"th"),o(29,"Total Descuento"),a()()(),i(30,"tbody"),R(31,ee,19,5,"tr",null,$,!1,te,3,0,"tr"),a()()(),i(34,"div",13)(35,"div",14),o(36),a()()()()),t&2&&(N("messageInput","Cargando...")("loading",r.cargando),l(31),k(r.temparios),l(5),O(" Mostrando ",r.temparios.length," tempario(s) "))},dependencies:[y,Z],encapsulation:2})};export{K as TempariosPrepagado};
