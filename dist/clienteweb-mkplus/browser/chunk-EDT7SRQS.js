import{a as P,b as O}from"./chunk-THYLNQNC.js";import{a as ae,b as le}from"./chunk-I4STTD3A.js";import"./chunk-OK34JCII.js";import{a as re}from"./chunk-3QEI6ENN.js";import{g as ee,h as ie,p as te,s as ne,u as oe,v as L}from"./chunk-RRJ2G4CW.js";import{a as I,b as W,d as F,e as U,g as q,h as H,i as K,j as Z,k as J,l as Q,m as N,n as A,p as V,t as X,u as Y,v as $}from"./chunk-YPYZVSIH.js";import"./chunk-I2A4HNRV.js";import{f as G,i as z}from"./chunk-PTR2WAUU.js";import{s as j}from"./chunk-JJK3Y3Z5.js";import{Bb as g,Db as h,Ea as a,Ob as t,Pb as v,Qb as x,Va as w,Vb as d,Wb as m,Xb as p,aa as f,bc as D,fa as E,fb as k,ga as M,gb as T,hb as y,jb as _,kb as b,lb as S,mb as i,nb as e,ob as u,ub as C}from"./chunk-XFJKNVDY.js";import{h as B}from"./chunk-FJYW2LMB.js";function pe(c,l){if(c&1&&(i(0,"option",15),t(1),e()),c&2){let r=l.$implicit;S("value",r.value),a(),x(" ",r.text," ")}}function ue(c,l){if(c&1){let r=C();i(0,"li",24),t(1),i(2,"button",34),g("click",function(){let s=E(r).$index,n=h();return M(n.eliminarVersion(s))}),t(3,"x"),e()()}if(c&2){let r=l.$implicit;a(),x(" ",r," ")}}function ve(c,l){if(c&1){let r=C();i(0,"button",35),g("click",function(){E(r);let s=h();return M(s.crear())}),t(1," GUARDAR "),e()}}var R=class c{modalActivo=f(ee);serviciosService=f(P);utilidadesService=f(L);evento="EVENTO_GUARDAR";servicio=structuredClone(ae);cargando=!1;versionTemporal="";tipoOperacionesOpciones=O;agregarVersion(){this.versionTemporal.trim()&&(this.servicio.modelo.version.push(this.versionTemporal.trim()),this.versionTemporal="")}eliminarVersion(l){this.servicio.modelo.version.splice(l,1)}crear=()=>{this.cargando=!0,this.serviciosService.crearServicio(this.servicio).subscribe({next:l=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",l.resultadoOperacion,"Aceptar"),this.modalActivo.close(l.estatus)},error:l=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",l.error.resultadoOperacion,"Aceptar")}})};static \u0275fac=function(r){return new(r||c)};static \u0275cmp=w({type:c,selectors:[["app-modal-servicios"]],inputs:{evento:"evento"},decls:101,vars:15,consts:[["tabindex","-1","role","dialog","aria-modal","true","tabindex","-1","aria-modal","true","role","dialog",1,"modal","fade","show","d-block"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"formulario-servicio"],[1,"mb-3"],[1,"row","mb-3"],[1,"col-md-3"],[1,"form-label"],["type","text",1,"form-control",3,"ngModelChange","ngModel"],["type","number",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-select",3,"ngModelChange","ngModel"],[3,"value"],[1,"form-check","form-switch","mb-4"],["type","checkbox",1,"form-check-input",3,"ngModelChange","ngModel"],[1,"form-check-label"],[1,"col-md-4"],[1,"input-group"],[1,"btn","btn-outline-dark",3,"click"],[1,"mb-2"],[1,"list-group","mb-4"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],[1,"col-md-4","d-flex","align-items-center"],[1,"form-check","form-switch"],[1,"col-12"],[1,"text-muted"],[1,"col-md-6"],[1,"form-check","form-switch","mb-3"],[1,"modal-footer"],["type","button",1,"btn","boton-secondary-kia",3,"click"],["type","button",1,"btn","boton-principal-kia"],[1,"btn","btn-sm","btn-danger",3,"click"],["type","button",1,"btn","boton-principal-kia",3,"click"]],template:function(r,o){r&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5",4),t(5,"Formulario Paquetes"),e(),u(6,"button",5),e(),i(7,"div",6)(8,"div",7)(9,"h3",8),t(10,"Datos del Servicio"),e(),i(11,"div",9)(12,"div",10)(13,"label",11),t(14,"Nombre"),e(),i(15,"input",12),p("ngModelChange",function(n){return m(o.servicio.nombre,n)||(o.servicio.nombre=n),n}),e()(),i(16,"div",10)(17,"label",11),t(18,"Descripci\xF3n"),e(),i(19,"input",12),p("ngModelChange",function(n){return m(o.servicio.descripcion,n)||(o.servicio.descripcion=n),n}),e()(),i(20,"div",10)(21,"label",11),t(22,"Cantidad"),e(),i(23,"input",13),p("ngModelChange",function(n){return m(o.servicio.cantidad,n)||(o.servicio.cantidad=n),n}),e()(),i(24,"div",10)(25,"label",11),t(26,"Tipo"),e(),i(27,"select",14),p("ngModelChange",function(n){return m(o.servicio.tipo,n)||(o.servicio.tipo=n),n}),_(28,pe,2,2,"option",15,y),e()()(),i(30,"div",16)(31,"input",17),p("ngModelChange",function(n){return m(o.servicio.tarifaManoObraUnificada,n)||(o.servicio.tarifaManoObraUnificada=n),n}),e(),i(32,"label",18),t(33,"Tarifa Mano de Obra Unificada"),e()(),u(34,"hr"),i(35,"h3",8),t(36,"Modelo al que Aplica"),e(),i(37,"div",9)(38,"div",19)(39,"label",11),t(40,"C\xF3digo del Modelo"),e(),i(41,"input",12),p("ngModelChange",function(n){return m(o.servicio.modelo.codigo,n)||(o.servicio.modelo.codigo=n),n}),e()(),i(42,"div",19)(43,"label",11),t(44,"Descripci\xF3n"),e(),i(45,"input",12),p("ngModelChange",function(n){return m(o.servicio.modelo.descripcion,n)||(o.servicio.modelo.descripcion=n),n}),e()(),i(46,"div",19)(47,"label",11),t(48,"Agregar Versi\xF3n"),e(),i(49,"div",20)(50,"input",12),p("ngModelChange",function(n){return m(o.versionTemporal,n)||(o.versionTemporal=n),n}),e(),i(51,"button",21),g("click",function(){return o.agregarVersion()}),t(52,"+"),e()()()(),i(53,"h4",22),t(54,"Versiones"),e(),i(55,"ul",23),_(56,ue,4,1,"li",24,y),e(),u(58,"hr"),i(59,"h3",8),t(60,"Vigencia"),e(),i(61,"div",9)(62,"div",19)(63,"label",11),t(64,"Kilometraje"),e(),i(65,"input",13),p("ngModelChange",function(n){return m(o.servicio.vigencia.kilometraje,n)||(o.servicio.vigencia.kilometraje=n),n}),e()(),i(66,"div",19)(67,"label",11),t(68,"Meses"),e(),i(69,"input",13),p("ngModelChange",function(n){return m(o.servicio.vigencia.meses,n)||(o.servicio.vigencia.meses=n),n}),e()(),i(70,"div",25)(71,"div",26)(72,"input",17),p("ngModelChange",function(n){return m(o.servicio.vigencia.autorizadoPorImportadora,n)||(o.servicio.vigencia.autorizadoPorImportadora=n),n}),e(),i(73,"label",18),t(74,"Autorizaci\xF3n"),e()()(),i(75,"div",27)(76,"small",28),t(77," Si est\xE1 activada, las vigencias no ser\xE1n tenidas en cuenta "),e()()(),u(78,"hr"),i(79,"h3",8),t(80,"Frecuencia"),e(),i(81,"div",9)(82,"div",29)(83,"label",11),t(84,"Kilometraje"),e(),i(85,"input",13),p("ngModelChange",function(n){return m(o.servicio.frecuencia.kilometraje,n)||(o.servicio.frecuencia.kilometraje=n),n}),e()(),i(86,"div",29)(87,"label",11),t(88,"Meses"),e(),i(89,"input",13),p("ngModelChange",function(n){return m(o.servicio.frecuencia.meses,n)||(o.servicio.frecuencia.meses=n),n}),e()()(),u(90,"hr"),i(91,"h3",8),t(92,"Activaci\xF3n del Servicio"),e(),i(93,"div",30)(94,"input",17),p("ngModelChange",function(n){return m(o.servicio.activo,n)||(o.servicio.activo=n),n}),e(),i(95,"label",18),t(96," Si el servicio no est\xE1 activo, no estar\xE1 disponible en la oferta comercial "),e()()()(),i(97,"div",31)(98,"button",32),g("click",function(){return o.modalActivo.close(!1)}),t(99," CANCELAR "),e(),k(100,ve,2,0,"button",33),e()()()()),r&2&&(a(15),d("ngModel",o.servicio.nombre),a(4),d("ngModel",o.servicio.descripcion),a(4),d("ngModel",o.servicio.cantidad),a(4),d("ngModel",o.servicio.tipo),a(),b(o.tipoOperacionesOpciones),a(3),d("ngModel",o.servicio.tarifaManoObraUnificada),a(10),d("ngModel",o.servicio.modelo.codigo),a(4),d("ngModel",o.servicio.modelo.descripcion),a(5),d("ngModel",o.versionTemporal),a(6),b(o.servicio.modelo.version),a(9),d("ngModel",o.servicio.vigencia.kilometraje),a(4),d("ngModel",o.servicio.vigencia.meses),a(3),d("ngModel",o.servicio.vigencia.autorizadoPorImportadora),a(13),d("ngModel",o.servicio.frecuencia.kilometraje),a(4),d("ngModel",o.servicio.frecuencia.meses),a(5),d("ngModel",o.servicio.activo),a(6),T(o.evento==="EVENTO_GUARDAR"?100:-1))},dependencies:[Y,A,V,W,K,I,N,F,q],encapsulation:2})};var ge=c=>["/admin/detalles-servicio",c],fe=(c,l)=>l._id;function Se(c,l){if(c&1&&(i(0,"option",29),t(1),e()),c&2){let r=l.$implicit;S("value",r.value),a(),v(r.text)}}function _e(c,l){if(c&1){let r=C();i(0,"form",6)(1,"div",16)(2,"div",17)(3,"div",18)(4,"label",19),t(5,"Modelo"),e(),u(6,"input",20),e(),i(7,"div",18)(8,"label",21),t(9," Versiones "),u(10,"i",22),e(),u(11,"input",23),e()(),i(12,"div",18)(13,"label",19),t(14,"Nombre"),e(),u(15,"input",24),e(),i(16,"div",18)(17,"label",19),t(18,"Descripci\xF3n"),e(),u(19,"input",25),e(),i(20,"div",26)(21,"label",19),t(22,"Tipo"),e(),i(23,"select",27)(24,"option",28),t(25,"Seleccione"),e(),_(26,Se,2,2,"option",29,y),e()(),i(28,"div",30)(29,"div",31),u(30,"input",32),i(31,"label",33),t(32,"Activos"),e()()(),i(33,"div",30)(34,"button",34),g("click",function(){E(r);let s=h();return M(s.consulta())}),t(35," Buscar "),e()()()()}if(c&2){let r=h();S("formGroup",r.formFiltro),a(26),b(r.operacionesListadoOpciones)}}function be(c,l){if(c&1&&(i(0,"span",35),t(1),e()),c&2){let r=l.$implicit;a(),v(r)}}function he(c,l){if(c&1){let r=C();i(0,"tr")(1,"td"),t(2),e(),i(3,"td"),t(4),e(),i(5,"td"),t(6),e(),i(7,"td"),t(8),e(),i(9,"td"),_(10,be,2,1,"span",35,y),e(),i(12,"td"),t(13),e(),i(14,"td"),t(15),e(),i(16,"td"),t(17),e(),i(18,"td"),t(19),e(),i(20,"td")(21,"button",36),u(22,"i",37),e(),i(23,"button",38),g("click",function(){let s=E(r).$implicit,n=h();return M(n.eliminar(s._id??""))}),u(24,"i",39),e()()()}if(c&2){let r=l.$implicit;a(2),v(r.nombre),a(2),v(r.descripcion),a(2),v(r.tipo),a(2),v(r.modelo.codigo),a(2),b(r.modelo.version),a(3),v(r.frecuencia.kilometraje),a(2),v(r.frecuencia.meses),a(2),v(r.vigencia.kilometraje),a(2),v(r.vigencia.meses),a(2),S("routerLink",D(9,ge,r._id??""))}}function Ee(c,l){c&1&&(i(0,"tr")(1,"td",40),t(2," No hay servicios registrados. "),e()())}var ce=class c{fb=f(X);utilidadesService=f(L);servicioService=f(P);modalService=f(ie);cargando=!1;servicios=[];total=0;pagina=1;filtro=structuredClone(le);operacionesListadoOpciones=O;formFiltro;constructor(){this.crearFormulario(),this.consulta()}crear=()=>B(this,null,function*(){(yield this.modalService.open(R,{centered:!0,size:"xl"}).result)&&this.consulta()});consulta=()=>{this.filtro=this.formFiltro.value,this.cargando=!0,this.servicioService.consultarServicios(this.filtro).subscribe({next:l=>{this.cargando=!1,l.estatus?(this.servicios=l.data.servicios,this.total=l.data.total):this.utilidadesService.abrirModalInfo("Informaci\xF3n",l.resultadoOperacion,"Aceptar")},error:l=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",l.error.resultadoOperacion,"Aceptar")}})};eliminar=l=>{this.cargando=!0,this.servicioService.eliminarServicio({id:l}).subscribe({next:r=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",r.resultadoOperacion,"Aceptar"),r.estatus&&this.consulta()},error:r=>{this.cargando=!1,this.utilidadesService.abrirModalInfo("Informaci\xF3n",r.error.resultadoOperacion,"Aceptar")}})};cambiarPagina=l=>{this.filtro.salto=(l-1)*this.filtro.limite,this.consulta()};crearFormulario(){this.formFiltro=this.fb.group({nombre:[""],descripcion:[""],tipo:[""],activo:[!0],salto:[0],modelo:this.fb.group({codigo:[""],version:[""]}),limite:10})}static \u0275fac=function(r){return new(r||c)};static \u0275cmp=w({type:c,selectors:[["app-servicios"]],decls:51,vars:9,consts:[[3,"messageInput","loading"],[1,"container-fluid","p-5","mt-5",2,"min-height","70vh"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"fw-bold","text-dark","mb-1"],[1,"text-muted","mb-0"],[1,"btn","boton-principal-kia",3,"click"],[3,"formGroup"],[1,"card","border-0","shadow-sm","rounded-4","mt-5"],[1,"table-responsive"],[1,"table","table-striped","table-bordered","text-center","align-middle","mb-0"],[1,"table-light"],["rowspan","2"],["colspan","2"],[1,"card-footer","d-flex","justify-content-between","align-items-center"],[1,"text-muted"],[3,"pageChange","collectionSize","pageSize","maxSize","page"],[1,"row","g-3"],["formGroupName","modelo",1,"row","g-3"],[1,"col-md-3"],[1,"form-label"],["formControlName","codigo",1,"form-control"],["ngbTooltip","Si deseas filtrar por varias versiones, separalas con una coma",1,"form-label"],[1,"fas","fa-circle-info","small"],["formControlName","version",1,"form-control"],["formControlName","nombre",1,"form-control"],["formControlName","descripcion",1,"form-control"],[1,"col-md-4"],["formControlName","tipo",1,"form-select"],["value",""],[3,"value"],[1,"col-md-1","d-flex","align-items-end"],[1,"form-check","form-switch"],["type","checkbox","formControlName","activo",1,"form-check-input"],[1,"form-check-label","fw-bold"],[1,"btn","btn-outline-secondary",3,"click"],[1,"badge","bg-secondary","me-1"],[1,"btn","btn-outline-dark","rounded-pill","px-3","me-2",3,"routerLink"],[1,"fa-solid","fa-pen-to-square"],[1,"btn","btn-outline-secondary","rounded-pill","px-3",3,"click"],[1,"fa-solid","fa-trash"],["colspan","10",1,"py-4","text-muted"]],template:function(r,o){r&1&&(u(0,"app-loading-screen",0),i(1,"div",1)(2,"div",2)(3,"div")(4,"h3",3),t(5,"Servicios"),e(),i(6,"p",4),t(7," Gesti\xF3n y administraci\xF3n de servicios registrados en la plataforma. "),e()(),i(8,"button",5),g("click",function(){return o.crear()}),t(9," Nuevo servicio "),e()(),k(10,_e,36,1,"form",6),i(11,"div",7)(12,"div",8)(13,"table",9)(14,"thead",10)(15,"tr")(16,"th",11),t(17,"Nombre"),e(),i(18,"th",11),t(19,"Descripci\xF3n"),e(),i(20,"th",11),t(21,"Tipo"),e(),i(22,"th",12),t(23,"Modelo"),e(),i(24,"th",12),t(25,"Frecuencia"),e(),i(26,"th",12),t(27,"Vigencia"),e(),i(28,"th",11),t(29,"Acciones"),e()(),i(30,"tr")(31,"th"),t(32,"Codigo"),e(),i(33,"th"),t(34,"Version"),e(),i(35,"th"),t(36,"Kilometraje"),e(),i(37,"th"),t(38,"Meses"),e(),i(39,"th"),t(40,"Kilometraje"),e(),i(41,"th"),t(42,"Meses"),e()()(),i(43,"tbody"),_(44,he,25,11,"tr",null,fe,!1,Ee,3,0,"tr"),e()()(),i(47,"div",13)(48,"div",14),t(49),e(),i(50,"ngb-pagination",15),g("pageChange",function(n){return o.cambiarPagina(n)}),p("pageChange",function(n){return m(o.pagina,n)||(o.pagina=n),n}),e()()()()),r&2&&(S("messageInput","Cargando...")("loading",o.cargando),a(10),T(o.formFiltro?10:-1),a(34),b(o.servicios),a(5),x(" Mostrando ",o.servicios.length," servicio(s) "),a(),S("collectionSize",o.total)("pageSize",o.filtro.limite)("maxSize",10),d("page",o.pagina))},dependencies:[re,oe,te,ne,$,H,A,V,W,I,N,F,U,Z,Q,J,j,z,G],encapsulation:2})};export{ce as Servicios};
